<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Processor Counter Monitor: cpucounters.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Processor Counter Monitor
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">cpucounters.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="cpucounters_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">Copyright (c) 2009-2020, Intel Corporation</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">All rights reserved.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">    * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">    * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">    * Neither the name of Intel Corporation nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// written by Roman Dementiev</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//            Thomas Willhalm</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifndef CPUCOUNTERS_HEADER</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define CPUCOUNTERS_HEADER</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define PCM_VERSION &quot; ($Format:%ci ID=%h$)&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#ifndef PCM_API</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#define PCM_API</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#undef PCM_HA_REQUESTS_READS_ONLY</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="types_8h.html">types.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="msr_8h.html">msr.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="pci_8h.html">pci.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="client__bw_8h.html">client_bw.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="width__extender_8h.html">width_extender.h</a>&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;exceptions/unsupported_processor_exception.hpp&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#ifdef PCM_USE_PERF</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;linux/perf_event.h&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#define PCM_PERF_COUNT_HW_REF_CPU_CYCLES (9)</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#ifndef _MSC_VER</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#define NOMINMAX</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;semaphore.h&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &lt;sys/syscall.h&gt;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">class </span><a class="code" href="classSystemCounterState.html">SystemCounterState</a>;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="keyword">class </span><a class="code" href="classSocketCounterState.html">SocketCounterState</a>;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keyword">class </span><a class="code" href="classCoreCounterState.html">CoreCounterState</a>;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="keyword">class </span><a class="code" href="classServerUncoreCounterState.html">ServerUncoreCounterState</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">class </span><a class="code" href="classCoreTaskQueue.html">CoreTaskQueue</a>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="keyword">class </span><a class="code" href="classSystemRoot.html">SystemRoot</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#if _MSC_VER&gt;= 1600</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &lt;intrin.h&gt;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">void</span> PCM_API restrictDriverAccess(LPCWSTR path);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">        CPU performance monitoring routines</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">        A set of performance monitoring routines for recent Intel CPUs</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structTopologyEntry.html">   86</a></span>&#160;<span class="keyword">struct </span>PCM_API <a class="code" href="structTopologyEntry.html">TopologyEntry</a> <span class="comment">// decribes a core</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    int32 os_id;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    int32 thread_id;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    int32 core_id;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    int32 tile_id; <span class="comment">// tile is a constalation of 1 or more cores sharing salem L2 cache. Unique for entire system</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    int32 socket;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structTopologyEntry.html">TopologyEntry</a>() : os_id(-1), thread_id (-1), core_id(-1), tile_id(-1), socket(-1) { }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;};</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classHWRegister.html">   97</a></span>&#160;<span class="keyword">class </span><a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">void</span> operator = (uint64 val) = 0; <span class="comment">// write operation</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">virtual</span> <span class="keyword">operator</span> uint64 () = 0; <span class="comment">//read operation</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classHWRegister.html">HWRegister</a>() {}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;};</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classPCICFGRegister64.html">  105</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPCICFGRegister64.html">PCICFGRegister64</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;{</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    std::shared_ptr&lt;PciHandleType&gt; handle;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">size_t</span> offset;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="classPCICFGRegister64.html">PCICFGRegister64</a>(<span class="keyword">const</span> std::shared_ptr&lt;PciHandleType&gt; &amp; handle_, <span class="keywordtype">size_t</span> offset_) :</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        handle(handle_),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        offset(offset_)</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 <span class="comment">/*val*/</span>)<span class="keyword"> override</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;PCICFGRegister64 write operation is not supported\n&quot;</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">throw</span> std::exception();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword">  override</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        uint64 result = 0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        handle-&gt;read64(offset, &amp;result);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;};</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classPCICFGRegister32.html">  128</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPCICFGRegister32.html">PCICFGRegister32</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    std::shared_ptr&lt;PciHandleType&gt; handle;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">size_t</span> offset;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classPCICFGRegister32.html">PCICFGRegister32</a>(<span class="keyword">const</span> std::shared_ptr&lt;PciHandleType&gt; &amp; handle_, <span class="keywordtype">size_t</span> offset_) :</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        handle(handle_),</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        offset(offset_)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 val)<span class="keyword"> override</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        handle-&gt;write32(offset, (uint32)val);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword"> override</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        uint32 result = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        handle-&gt;read32(offset, &amp;result);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;};</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classMMIORegister64.html">  150</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMMIORegister64.html">MMIORegister64</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    std::shared_ptr&lt;MMIORange&gt; handle;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordtype">size_t</span> offset;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="classMMIORegister64.html">MMIORegister64</a>(<span class="keyword">const</span> std::shared_ptr&lt;MMIORange&gt; &amp; handle_, <span class="keywordtype">size_t</span> offset_) :</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        handle(handle_),</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        offset(offset_)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 val)<span class="keyword"> override</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        handle-&gt;write64(offset, val);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword"> override</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">return</span> handle-&gt;read64(offset);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;};</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="classMMIORegister32.html">  170</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMMIORegister32.html">MMIORegister32</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::shared_ptr&lt;MMIORange&gt; handle;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordtype">size_t</span> offset;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classMMIORegister32.html">MMIORegister32</a>(<span class="keyword">const</span> std::shared_ptr&lt;MMIORange&gt; &amp; handle_, <span class="keywordtype">size_t</span> offset_) :</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        handle(handle_),</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        offset(offset_)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 val)<span class="keyword"> override</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        handle-&gt;write32(offset, (uint32)val);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword"> override</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> (uint64)handle-&gt;read32(offset);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;};</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classMSRRegister.html">  190</a></span>&#160;<span class="keyword">class </span><a class="code" href="classMSRRegister.html">MSRRegister</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    std::shared_ptr&lt;SafeMsrHandle&gt; handle;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">size_t</span> offset;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classMSRRegister.html">MSRRegister</a>(<span class="keyword">const</span> std::shared_ptr&lt;SafeMsrHandle&gt; &amp; handle_, <span class="keywordtype">size_t</span> offset_) :</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        handle(handle_),</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        offset(offset_)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 val)<span class="keyword"> override</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        handle-&gt;write(offset, val);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword"> override</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        uint64 value = 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        handle-&gt;read(offset, &amp;value);</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">return</span> value;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;};</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classCounterWidthExtenderRegister.html">  212</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCounterWidthExtenderRegister.html">CounterWidthExtenderRegister</a> : <span class="keyword">public</span> <a class="code" href="classHWRegister.html">HWRegister</a></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    std::shared_ptr&lt;CounterWidthExtender&gt; handle;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="classCounterWidthExtenderRegister.html">CounterWidthExtenderRegister</a>(<span class="keyword">const</span> std::shared_ptr&lt;CounterWidthExtender&gt; &amp; handle_) :</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        handle(handle_)</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    {</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordtype">void</span> operator = (uint64 val)<span class="keyword"> override</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">if</span> (val == 0)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            handle-&gt;reset();</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: writing non-zero values to CounterWidthExtenderRegister is not supported\n&quot;</span>;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">throw</span> std::exception();</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">operator</span> uint64 ()<span class="keyword"> override</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> handle-&gt;read();;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;};</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">#undef PCM_UNCORE_PMON_BOX_CHECK_STATUS // debug only</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classUncorePMU.html">  240</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUncorePMU.html">UncorePMU</a></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;{</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">typedef</span> std::shared_ptr&lt;HWRegister&gt; HWRegisterPtr;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    HWRegisterPtr unitControl;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    HWRegisterPtr counterControl[4];</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    HWRegisterPtr counterValue[4];</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    HWRegisterPtr fixedCounterControl;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    HWRegisterPtr fixedCounterValue;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    HWRegisterPtr filter[2];</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="classUncorePMU.html">UncorePMU</a>(<span class="keyword">const</span> HWRegisterPtr &amp; unitControl_,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterControl0,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterControl1,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterControl2,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterControl3,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterValue0,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterValue1,</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterValue2,</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; counterValue3,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; fixedCounterControl_ = HWRegisterPtr(),</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; fixedCounterValue_ = HWRegisterPtr(),</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; filter0 = HWRegisterPtr(),</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keyword">const</span> HWRegisterPtr &amp; filter1 = HWRegisterPtr()</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    ) :</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        unitControl(unitControl_),</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        counterControl{ counterControl0, counterControl1, counterControl2, counterControl3 },</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        counterValue{ counterValue0, counterValue1, counterValue2, counterValue3 },</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        fixedCounterControl(fixedCounterControl_),</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        fixedCounterValue(fixedCounterValue_),</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        filter{ filter0 , filter1 }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="classUncorePMU.html">UncorePMU</a>() {}</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classUncorePMU.html">UncorePMU</a>() {}</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">bool</span> valid()<span class="keyword"> const</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">return</span> unitControl.get() != <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordtype">void</span> writeUnitControl(<span class="keyword">const</span> uint32 value)</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        *unitControl = value;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">void</span> cleanup();</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">void</span> freeze(<span class="keyword">const</span> uint32 extra);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">bool</span> initFreeze(<span class="keyword">const</span> uint32 extra, <span class="keyword">const</span> <span class="keywordtype">char</span>* xPICheckMsg = <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordtype">void</span> unfreeze(<span class="keyword">const</span> uint32 extra);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordtype">void</span> resetUnfreeze(<span class="keyword">const</span> uint32 extra);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;};</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html">  291</a></span>&#160;<span class="keyword">class </span><a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;{</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    int32 iMCbus,UPIbus,M2Mbus;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    uint32 groupnr;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    int32 cpu_model;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keyword">typedef</span> std::vector&lt;UncorePMU&gt; UncorePMUVector;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    UncorePMUVector imcPMUs;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    UncorePMUVector edcPMUs;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    UncorePMUVector xpiPMUs;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    UncorePMUVector m2mPMUs;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    UncorePMUVector haPMUs;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    std::vector&lt;UncorePMUVector*&gt; allPMUs{ &amp;imcPMUs, &amp;edcPMUs, &amp;xpiPMUs, &amp;m2mPMUs, &amp;haPMUs };</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    std::vector&lt;uint64&gt; qpi_speed;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    std::vector&lt;uint32&gt; num_imc_channels; <span class="comment">// number of memory channels in each memory controller</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; XPIRegisterLocation; <span class="comment">// (device, function)</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    std::vector&lt;std::vector&lt; std::pair&lt;uint32, uint32&gt; &gt; &gt; MCRegisterLocation; <span class="comment">// MCRegisterLocation[controller]: (device, function)</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; EDCRegisterLocation; <span class="comment">// EDCRegisterLocation: (device, function)</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; M2MRegisterLocation; <span class="comment">// M2MRegisterLocation: (device, function)</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; HARegisterLocation;  <span class="comment">// HARegisterLocation: (device, function)</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keyword">static</span> <a class="code" href="classPCM__Util_1_1Mutex.html">PCM_Util::Mutex</a> socket2busMutex;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">static</span> std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; socket2iMCbus;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keyword">static</span> std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; socket2UPIbus;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keyword">static</span> std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; socket2M2Mbus;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordtype">void</span> initSocket2Bus(std::vector&lt;std::pair&lt;uint32, uint32&gt; &gt; &amp; socket2bus, uint32 device, uint32 <span class="keyword">function</span>, <span class="keyword">const</span> uint32 DEV_IDS[], uint32 devIdsSize);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>();                                         <span class="comment">// forbidden</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>(<a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a> &amp;);                     <span class="comment">// forbidden</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a> &amp; operator = (<span class="keyword">const</span> <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a> &amp;); <span class="comment">// forbidden</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    PciHandleType * createIntelPerfMonDevice(uint32 groupnr, int32 bus, uint32 dev, uint32 func, <span class="keywordtype">bool</span> checkVendor = <span class="keyword">false</span>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">void</span> programIMC(<span class="keyword">const</span> uint32 * MCCntConfig);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">void</span> programEDC(<span class="keyword">const</span> uint32 * EDCCntConfig);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">void</span> programM2M(<span class="keyword">const</span> uint32 * M2MCntConfig);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">void</span> programM2M();</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordtype">void</span> programHA(<span class="keyword">const</span> uint32 * config);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordtype">void</span> programHA();</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordtype">void</span> programXPI(<span class="keyword">const</span> uint32 * XPICntConfig);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">typedef</span> std::pair&lt;size_t, std::vector&lt;uint64 *&gt; &gt; MemTestParam;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">void</span> initMemTest(MemTestParam &amp; param);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">void</span> doMemTest(<span class="keyword">const</span> MemTestParam &amp; param);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">void</span> cleanupMemTest(<span class="keyword">const</span> MemTestParam &amp; param);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordtype">void</span> cleanupQPIHandles();</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordtype">void</span> cleanupPMUs();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">void</span> writeAllUnitControl(<span class="keyword">const</span> uint32 value);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">void</span> initDirect(uint32 socket_, <span class="keyword">const</span> <a class="code" href="classPCM.html">PCM</a> * pcm);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordtype">void</span> initPerf(uint32 socket_, <span class="keyword">const</span> <a class="code" href="classPCM.html">PCM</a> * pcm);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordtype">void</span> initBuses(uint32 socket_, <span class="keyword">const</span> <a class="code" href="classPCM.html">PCM</a> * pcm);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordtype">void</span> initRegisterLocations(<span class="keyword">const</span> <a class="code" href="classPCM.html">PCM</a> * pcm);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    uint64 getPMUCounter(std::vector&lt;UncorePMU&gt; &amp; pmu, <span class="keyword">const</span> uint32 <span class="keywordtype">id</span>, <span class="keyword">const</span> uint32 <a class="code" href="structcounter.html">counter</a>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keyword">enum</span> EventPosition {</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        READ=0,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        WRITE=1,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        READ_RANK_A=0,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        WRITE_RANK_A=1,</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        READ_RANK_B=2,</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        WRITE_RANK_B=3,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        PARTIAL=2,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        PMM_READ=2,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        PMM_WRITE=3,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        PMM_MM_MISS_CLEAN=2,</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        PMM_MM_MISS_DIRTY=3,</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        NM_HIT=0,  <span class="comment">// NM :  Near Memory (DRAM cache) in Memory Mode</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        M2M_CLOCKTICKS=1</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    };</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>(uint32 socket_, <span class="keyword">const</span> <a class="code" href="classPCM.html">PCM</a> * pcm);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#abae9577a1a172c944d133bef10683825">program</a>();</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    uint64 getImcReads();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    uint64 getImcReadsForController(uint32 controller);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    uint64 getImcReadsForChannels(uint32 beginChannel, uint32 endChannel);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    uint64 getImcWrites();</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    uint64 getHALocalRequests();</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    uint64 getHARequests();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    uint64 getPMMReads();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    uint64 getPMMWrites();</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    uint64 getEdcReads();</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    uint64 getEdcWrites();</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    uint64 getIncomingDataFlits(uint32 port);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    uint64 getOutgoingFlits(uint32 port);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    ~<a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>();</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">void</span> program_power_metrics(<span class="keywordtype">int</span> mc_profile);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a9927f044c832bbdcd369c7bc1ad986c6">programServerUncoreMemoryMetrics</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> rankA = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> rankB = -1, <span class="keyword">const</span> <span class="keywordtype">bool</span> PMM = <span class="keyword">false</span>, <span class="keyword">const</span> <span class="keywordtype">bool</span> PMMMixedMode = <span class="keyword">false</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(uint32 port);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(uint32 port);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    uint64 getUPIL0TxCycles(uint32 port);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(uint32 port);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a>(uint32 channel);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#a1615063ac14cde3ace1a91bfb349f3f9">getMCDRAMClocks</a>(uint32 channel);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a>(uint32 channel, uint32 counter);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#a996fd8a127111e06540302cf9ccb24a7">getEDCCounter</a>(uint32 channel, uint32 counter);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    uint64 getQPILLCounter(uint32 port, uint32 counter);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    uint64 <a class="code" href="cpucounters_8h.html#a7dc8446d1f6172bdac1401e5d3ec0a4d">getM2MCounter</a>(uint32 box, uint32 counter);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">void</span> freezeCounters();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">void</span> unfreezeCounters();</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    uint64 computeQPISpeed(<span class="keyword">const</span> uint32 ref_core, <span class="keyword">const</span> <span class="keywordtype">int</span> cpumodel);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">void</span> enableJKTWorkaround(<span class="keywordtype">bool</span> enable);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#a5dc6e057441bbbbc3d396fe8e5d7cc2f">  460</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classServerPCICFGUncore.html#a5dc6e057441bbbbc3d396fe8e5d7cc2f">getNumQPIPorts</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> xpiPMUs.size(); }</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#ae3421871d5942f1835af1fe4c282950b">  463</a></span>&#160;    uint64 <a class="code" href="classServerPCICFGUncore.html#ae3421871d5942f1835af1fe4c282950b">getQPILinkSpeed</a>(<span class="keyword">const</span> uint32 linkNr)<span class="keyword"> const</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">return</span> qpi_speed.empty() ? 0 : qpi_speed[linkNr];</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">void</span> reportQPISpeed() <span class="keyword">const</span>;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#a70765cb7dc2f54fae3528e6f15c57f45">  472</a></span>&#160;    uint32 <a class="code" href="classServerPCICFGUncore.html#a70765cb7dc2f54fae3528e6f15c57f45">getNumMC</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (uint32)num_imc_channels.size(); }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#ab59fb235a87be897547b1c32534d1a5f">  475</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classServerPCICFGUncore.html#ab59fb235a87be897547b1c32534d1a5f">getNumMCChannels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<span class="keywordtype">size_t</span>)imcPMUs.size(); }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">size_t</span> getNumMCChannels(<span class="keyword">const</span> uint32 controller) <span class="keyword">const</span>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classServerPCICFGUncore.html#abc8b36bca06eaa243b1013ae19374c2c">  482</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classServerPCICFGUncore.html#abc8b36bca06eaa243b1013ae19374c2c">getNumEDCChannels</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> edcPMUs.size(); }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;};</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="classSimpleCounterState.html">  485</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSimpleCounterState.html">SimpleCounterState</a></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a74fe887976e82116d27513e162a9a089">getNumberOfEvents</a>(<span class="keyword">const</span> <a class="code" href="structT.html">T</a> &amp; before, <span class="keyword">const</span> <a class="code" href="structT.html">T</a> &amp; after);</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    uint64 <a class="code" href="structdata.html">data</a>;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classSimpleCounterState.html">SimpleCounterState</a>() : data(0)</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    { }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classSimpleCounterState.html">SimpleCounterState</a>() { }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;};</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="keyword">typedef</span> <a class="code" href="classSimpleCounterState.html">SimpleCounterState</a> <a class="code" href="classSimpleCounterState.html">PCIeCounterState</a>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keyword">typedef</span> <a class="code" href="classSimpleCounterState.html">SimpleCounterState</a> <a class="code" href="classSimpleCounterState.html">IIOCounterState</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="keyword">typedef</span> std::vector&lt;uint64&gt; eventGroup_t;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="keyword">class </span>PerfVirtualControlRegister;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">#ifndef HACK_TO_REMOVE_DUPLICATE_ERROR</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::allocator&lt;TopologyEntry&gt;;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::vector&lt;TopologyEntry&gt;;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::allocator&lt;CounterWidthExtender *&gt;;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::vector&lt;CounterWidthExtender *&gt;;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::allocator&lt;uint32&gt;;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::vector&lt;uint32&gt;;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword">template</span> <span class="keyword">class </span>PCM_API std::allocator&lt;char&gt;;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="classPCM.html">  519</a></span>&#160;<span class="keyword">class </span>PCM_API <a class="code" href="classPCM.html">PCM</a></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a>;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classSocket.html">Socket</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classServerUncore.html">ServerUncore</a>;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span>PerfVirtualControlRegister;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classAggregator.html">Aggregator</a>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classServerPCICFGUncore.html">ServerPCICFGUncore</a>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="classPCM.html">PCM</a>();     <span class="comment">// forbidden to call directly because it is a singleton</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    int32 cpu_family;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    int32 cpu_model;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    int32 cpu_stepping;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    int64 cpu_microcode_level;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    int32 max_cpuid;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    int32 threads_per_core;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    int32 num_cores;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    int32 num_sockets;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    int32 num_phys_cores_per_socket;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    int32 num_online_cores;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    int32 num_online_sockets;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    uint32 core_gen_counter_num_max;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    uint32 core_gen_counter_num_used;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    uint32 core_gen_counter_width;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    uint32 core_fixed_counter_num_max;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    uint32 core_fixed_counter_num_used;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    uint32 core_fixed_counter_width;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    uint32 uncore_gen_counter_num_max;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    uint32 uncore_gen_counter_num_used;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    uint32 uncore_gen_counter_width;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    uint32 uncore_fixed_counter_num_max;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    uint32 uncore_fixed_counter_num_used;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    uint32 uncore_fixed_counter_width;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    uint32 perfmon_version;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    int32 perfmon_config_anythread;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    uint64 nominal_frequency;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    uint64 max_qpi_speed; <span class="comment">// in GBytes/second</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    uint32 L3ScalingFactor;</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    int32 pkgThermalSpecPower, pkgMinimumPower, pkgMaximumPower;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    std::vector&lt;TopologyEntry&gt; topology;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="classSystemRoot.html">SystemRoot</a>* systemTopology;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    std::string errorMessage;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keyword">static</span> <a class="code" href="classPCM.html">PCM</a> * instance;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordtype">bool</span> allow_multiple_instances;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordtype">bool</span> programmed_pmu;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    std::vector&lt;std::shared_ptr&lt;SafeMsrHandle&gt; &gt; MSR;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    std::vector&lt;std::shared_ptr&lt;ServerPCICFGUncore&gt; &gt; server_pcicfg_uncore;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    std::vector&lt;UncorePMU&gt; pcuPMUs;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    std::vector&lt;std::map&lt;int32, UncorePMU&gt; &gt; iioPMUs;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    std::vector&lt;UncorePMU&gt; uboxPMUs;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">double</span> joulesPerEnergyUnit;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    std::vector&lt;std::shared_ptr&lt;CounterWidthExtender&gt; &gt; energy_status;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    std::vector&lt;std::shared_ptr&lt;CounterWidthExtender&gt; &gt; dram_energy_status;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    std::vector&lt;std::vector&lt;UncorePMU&gt; &gt; cboPMUs;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    std::vector&lt;std::shared_ptr&lt;CounterWidthExtender&gt; &gt; memory_bw_local;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    std::vector&lt;std::shared_ptr&lt;CounterWidthExtender&gt; &gt; memory_bw_total;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    std::shared_ptr&lt;ClientBW&gt; clientBW;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    std::shared_ptr&lt;CounterWidthExtender&gt; clientImcReads;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    std::shared_ptr&lt;CounterWidthExtender&gt; clientImcWrites;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    std::shared_ptr&lt;CounterWidthExtender&gt; clientIoRequests;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordtype">bool</span> disable_JKT_workaround;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordtype">bool</span> blocked;              <span class="comment">// track if time-driven counter update is running or not: PCM is blocked</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    uint64 * coreCStateMsr;    <span class="comment">// MSR addresses of core C-state free-running counters</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    uint64 * pkgCStateMsr;     <span class="comment">// MSR addresses of package C-state free-running counters</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    std::vector&lt;std::shared_ptr&lt;CoreTaskQueue&gt; &gt; coreTaskQueues;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordtype">bool</span> L2CacheHitRatioAvailable;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordtype">bool</span> L3CacheHitRatioAvailable;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordtype">bool</span> L3CacheMissesAvailable;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordtype">bool</span> L2CacheMissesAvailable;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">bool</span> L2CacheHitsAvailable;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordtype">bool</span> L3CacheHitsNoSnoopAvailable;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">bool</span> L3CacheHitsSnoopAvailable;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">bool</span> L3CacheHitsAvailable;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordtype">bool</span> forceRTMAbortMode;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keyword">enum</span> { MAX_C_STATE = 10 }; <span class="comment">// max C-state on Intel architecture</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">  608</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">isCoreCStateResidencySupported</a>(<span class="keywordtype">int</span> state)</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    {</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> (state == 0 || state == 1)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">return</span> (coreCStateMsr != NULL &amp;&amp; state &lt;= ((<span class="keywordtype">int</span>)MAX_C_STATE) &amp;&amp; coreCStateMsr[state] != 0);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="classPCM.html#aad05d8a2f383ad41d25892175373b613">  617</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#aad05d8a2f383ad41d25892175373b613">isPackageCStateResidencySupported</a>(<span class="keywordtype">int</span> state)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">if</span> (state == 0)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">return</span> (pkgCStateMsr != NULL &amp;&amp; state &lt;= ((<span class="keywordtype">int</span>)MAX_C_STATE) &amp;&amp; pkgCStateMsr[state] != 0);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">void</span> setOutput(<span class="keyword">const</span> std::string filename);</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordtype">void</span> restoreOutput();</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// Arguments:</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="comment">//  -- 1 - program is running</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">//  -- 0 -pgram is sleeping</span></div><div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="classPCM.html#adb5b4989751f87a17649810a964fa053">  636</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#adb5b4989751f87a17649810a964fa053">setRunState</a>(<span class="keywordtype">int</span> new_state) { run_state = new_state; }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="comment">// Results:</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    <span class="comment">//  -- 1 - program is running</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">//  -- 0 -pgram is sleeping</span></div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">  642</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">getRunState</a>(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> run_state; }</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">bool</span> isBlocked(<span class="keywordtype">void</span>) { <span class="keywordflow">return</span> blocked; }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">void</span> setBlocked(<span class="keyword">const</span> <span class="keywordtype">bool</span> new_blocked) { blocked = new_blocked; }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno"><a class="line" href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">  648</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">allowMultipleInstances</a>()</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        allow_multiple_instances = <span class="keyword">true</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786">  654</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> {</div><div class="line"><a name="l00655"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786a0e861144f482697cfa423b012ed42451">  655</a></span>&#160;        DEFAULT_EVENTS = 0,         </div><div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786ac092b2b5f351e33046b87e5cee31f38f">  656</a></span>&#160;        CUSTOM_CORE_EVENTS = 1,     </div><div class="line"><a name="l00657"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786a0f2ff80b85b8f9483c7f03544f73fcbd">  657</a></span>&#160;        EXT_CUSTOM_CORE_EVENTS = 2, </div><div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="classPCM.html#a88584813a3ef51376efeb22928764786ad60e2f3b64e27eaaa84d2b07fea8e225">  658</a></span>&#160;        INVALID_MODE                </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    };</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno"><a class="line" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">  662</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> {</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        Success = 0,</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        MSRAccessDenied = 1,</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        PMUBusy = 2,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        UnknownError</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    };</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keyword">enum</span> PerfmonField {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        INVALID, <span class="comment">/* Use to parse invalid field */</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        OPCODE,</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        EVENT_SELECT,</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        UMASK,</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        RESET,</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        EDGE_DET,</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        IGNORED,</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        OVERFLOW_ENABLE,</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        ENABLE,</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        INVERT,</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        THRESH,</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        CH_MASK,</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        FC_MASK,</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">/* Below are not part of perfmon definition */</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        H_EVENT_NAME,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        V_EVENT_NAME,</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        MULTIPLIER,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        DIVIDER,</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        COUNTER_INDEX</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    };</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keyword">enum</span> PCIeWidthMode {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        X1,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        X4,</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        X8,</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        X16,</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        XFF</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    };</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keyword">enum</span> { <span class="comment">// offsets/enumeration of IIO stacks</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        IIO_CBDMA = 0, <span class="comment">// shared with DMI</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        IIO_PCIe0 = 1,</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        IIO_PCIe1 = 2,</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        IIO_PCIe2 = 3,</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        IIO_MCP0 = 4,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        IIO_MCP1 = 5,</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        IIO_STACK_COUNT = 6</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    };</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div><div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="structPCM_1_1SimplePCIeDevInfo.html">  709</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1SimplePCIeDevInfo.html">SimplePCIeDevInfo</a></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    {</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keyword">enum</span> PCIeWidthMode width;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        std::string pciDevName;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        std::string busNumber;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <a class="code" href="structPCM_1_1SimplePCIeDevInfo.html">SimplePCIeDevInfo</a>() : width(XFF) { }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    };</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno"><a class="line" href="structPCM_1_1CustomCoreEventDescription.html">  725</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1CustomCoreEventDescription.html">CustomCoreEventDescription</a></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    {</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        int32 event_number, umask_value;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    };</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">  739</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">ExtendedCustomCoreEventDescription</a></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    {</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="structFixedEventControlRegister.html">FixedEventControlRegister</a> * fixedCfg; <span class="comment">// if NULL, then default configuration performed for fixed counters</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        uint32 nGPCounters;                   <span class="comment">// number of general purpose counters</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="structEventSelectRegister.html">EventSelectRegister</a> * gpCounterCfg;   <span class="comment">// general purpose counters, if NULL, then default configuration performed for GP counters</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        uint64 OffcoreResponseMsrValue[2];</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <a class="code" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">ExtendedCustomCoreEventDescription</a>() : fixedCfg(NULL), nGPCounters(0), gpCounterCfg(NULL)</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            OffcoreResponseMsrValue[0] = 0;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            OffcoreResponseMsrValue[1] = 0;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    };</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="structPCM_1_1CustomIIOEventDescription.html">  752</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structPCM_1_1CustomIIOEventDescription.html">CustomIIOEventDescription</a></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="comment">/* We program the same counters to every IIO Stacks */</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        std::string eventNames[4];</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <a class="code" href="structIIOPMUCNTCTLRegister.html">IIOPMUCNTCTLRegister</a> eventOpcodes[4];</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordtype">int</span> multiplier[4]; <span class="comment">//Some IIO event requires transformation to get meaningful output (i.e. DWord to bytes)</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="keywordtype">int</span> divider[4]; <span class="comment">//We usually like to have some kind of divider (i.e. /10e6 )</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    };</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> mode;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="structPCM_1_1CustomCoreEventDescription.html">CustomCoreEventDescription</a> coreEventDesc[PERF_MAX_CUSTOM_COUNTERS];</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    HANDLE numInstancesSemaphore;     <span class="comment">// global semaphore that counts the number of PCM instances on the system</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="comment">// global semaphore that counts the number of PCM instances on the system</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    sem_t * numInstancesSemaphore;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    std::vector&lt;int32&gt; socketRefCore;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordtype">bool</span> canUsePerf;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="preprocessor">#ifdef PCM_USE_PERF</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    std::vector&lt;std::vector&lt;int&gt; &gt; perfEventHandle;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">void</span> readPerfData(uint32 core, std::vector&lt;uint64&gt; &amp; <a class="code" href="structdata.html">data</a>);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keyword">enum</span> {</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        PERF_INST_RETIRED_ANY_POS = 0,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        PERF_CPU_CLK_UNHALTED_THREAD_POS = 1,</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        PERF_CPU_CLK_UNHALTED_REF_POS = 2,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        PERF_GEN_EVENT_0_POS = 3,</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        PERF_GEN_EVENT_1_POS = 4,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        PERF_GEN_EVENT_2_POS = 5,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        PERF_GEN_EVENT_3_POS = 6</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    };</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keyword">enum</span> {</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        PERF_GROUP_LEADER_COUNTER = PERF_INST_RETIRED_ANY_POS</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    };</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    std::ofstream * outfile;       <span class="comment">// output file stream</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    std::streambuf * backup_ofile; <span class="comment">// backup of original output = cout</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordtype">int</span> run_state;                 <span class="comment">// either running (1) or sleeping (0)</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordtype">bool</span> needToRestoreNMIWatchdog;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    std::vector&lt;std::vector&lt;EventSelectRegister&gt; &gt; lastProgrammedCustomCounters;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    uint32 checkCustomCoreProgramming(std::shared_ptr&lt;SafeMsrHandle&gt; msr);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> programCoreCounters(<span class="keywordtype">int</span> core, <span class="keyword">const</span> <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">PCM::ProgramMode</a> mode, <span class="keyword">const</span> <a class="code" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">ExtendedCustomCoreEventDescription</a> * pExtDesc,</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        std::vector&lt;EventSelectRegister&gt; &amp; programmedCustomCounters);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordtype">bool</span> PMUinUse();</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordtype">void</span> cleanupPMU();</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordtype">void</span> freeRMID();</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordtype">bool</span> decrementInstanceSemaphore(); <span class="comment">// returns true if it was the last instance</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="preprocessor">#ifdef __APPLE__</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="comment">// OSX does not have sem_getvalue, so we must get the number of instances by a different method</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    uint32 getNumInstances();</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    uint32 decrementNumInstances();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    uint32 incrementNumInstances();</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordtype">void</span> computeQPISpeedBeckton(<span class="keywordtype">int</span> core_nr);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordtype">void</span> destroyMSR();</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordtype">void</span> computeNominalFrequency();</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> isCPUModelSupported(<span class="keywordtype">int</span> model_);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    std::string getSupportedUarchCodenames() <span class="keyword">const</span>;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    std::string getUnsupportedMessage() <span class="keyword">const</span>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordtype">bool</span> detectModel();</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordtype">bool</span> checkModel();</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="keywordtype">void</span> initCStateSupportTables();</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordtype">bool</span> discoverSystemTopology();</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordtype">void</span> printSystemTopology() <span class="keyword">const</span>;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordtype">bool</span> initMSR();</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keywordtype">bool</span> detectNominalFrequency();</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordtype">void</span> showSpecControlMSRs();</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordtype">void</span> initEnergyMonitoring();</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordtype">void</span> initUncoreObjects();</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">void</span> initRMID();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">void</span> initQOSevent(<span class="keyword">const</span> uint64 event, <span class="keyword">const</span> int32 core);</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">void</span> programBecktonUncore(<span class="keywordtype">int</span> core);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    <span class="keywordtype">void</span> programNehalemEPUncore(<span class="keywordtype">int</span> core);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">void</span> enableJKTWorkaround(<span class="keywordtype">bool</span> enable);</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordtype">void</span> readAndAggregateMemoryBWCounters(<span class="keyword">const</span> uint32 core, CounterStateType &amp; counterState);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">void</span> readAndAggregateUncoreMCCounters(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordtype">void</span> readAndAggregateEnergyCounters(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordtype">void</span> readPackageThermalHeadroom(<span class="keyword">const</span> uint32 socket, CounterStateType &amp; counterState);</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordtype">void</span> readAndAggregatePackageCStateResidencies(std::shared_ptr&lt;SafeMsrHandle&gt; msr, CounterStateType &amp; result);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">void</span> readQPICounters(<a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; counterState);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordtype">void</span> reportQPISpeed() <span class="keyword">const</span>;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">void</span> readCoreCounterConfig();</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordtype">void</span> readCPUMicrocodeLevel();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    uint64 CX_MSR_PMON_CTRY(uint32 Cbo, uint32 Ctr) <span class="keyword">const</span>;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    uint64 CX_MSR_PMON_BOX_FILTER(uint32 Cbo) <span class="keyword">const</span>;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    uint64 CX_MSR_PMON_BOX_FILTER1(uint32 Cbo) <span class="keyword">const</span>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    uint64 CX_MSR_PMON_CTLY(uint32 Cbo, uint32 Ctl) <span class="keyword">const</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    uint64 CX_MSR_PMON_BOX_CTL(uint32 Cbo) <span class="keyword">const</span>;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    uint32 getMaxNumOfCBoxes() <span class="keyword">const</span>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="keywordtype">void</span> programCboOpcodeFilter(<span class="keyword">const</span> uint32 opc0, <a class="code" href="classUncorePMU.html">UncorePMU</a> &amp; pmu, <span class="keyword">const</span> uint32 nc_, <span class="keyword">const</span> uint32 opc1, <span class="keyword">const</span> uint32 loc, <span class="keyword">const</span> uint32 rem);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">void</span> initLLCReadMissLatencyEvents(uint64 * events, uint32 &amp; opCode);</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="keywordtype">void</span> initCHARequestEvents(uint64 * events);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordtype">void</span> programCbo();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    uint64 getCBOCounterState(<span class="keyword">const</span> uint32 socket, <span class="keyword">const</span> uint32 ctr_);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordtype">void</span> cleanupUncorePMUs();</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordtype">bool</span> isCLX() <span class="keyword">const</span> <span class="comment">// Cascade Lake-SP</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">return</span> (PCM::SKX == cpu_model) &amp;&amp; (cpu_stepping &gt; 4 &amp;&amp; cpu_stepping &lt; 8);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    }</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> isCPX(<span class="keywordtype">int</span> cpu_model_, <span class="keywordtype">int</span> cpu_stepping_) <span class="comment">// Cooper Lake</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">return</span> (PCM::SKX == cpu_model_) &amp;&amp; (cpu_stepping_ &gt;= 10);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    <span class="keywordtype">bool</span> isCPX()<span class="keyword"> const</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">return</span> isCPX(cpu_model, cpu_stepping);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordtype">void</span> initUncorePMUsDirect();</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordtype">void</span> initUncorePMUsPerf();</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <span class="keywordtype">bool</span> isRDTDisabled() <span class="keyword">const</span>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keyword">enum</span> EventPosition</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        TOR_OCCUPANCY = 0,</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        TOR_INSERTS = 1,</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        REQUESTS_ALL = 2,</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        REQUESTS_LOCAL = 3</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    };</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordtype">bool</span> isSecureBoot() <span class="keyword">const</span>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordtype">bool</span> useLinuxPerfForUncore() <span class="keyword">const</span>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno"><a class="line" href="classPCM.html#ad23a4c0feeda389a1e56191a5740f95a">  916</a></span>&#160;    <a class="code" href="classSystemRoot.html">SystemRoot</a> <span class="keyword">const</span> &amp; <a class="code" href="classPCM.html#ad23a4c0feeda389a1e56191a5740f95a">getSystemTopology</a>()<span class="keyword"> const </span>{</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">return</span> *systemTopology;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordtype">bool</span> QOSMetricAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordtype">bool</span> L3QOSMetricAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordtype">bool</span> L3CacheOccupancyMetricAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">bool</span> CoreLocalMemoryBWMetricAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    <span class="keywordtype">bool</span> CoreRemoteMemoryBWMetricAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordtype">unsigned</span> getMaxRMID() <span class="keyword">const</span>;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keyword">static</span> <a class="code" href="classPCM.html">PCM</a> * getInstance();        <span class="comment">// the only way to get access</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <span class="keywordtype">bool</span> good();                       <span class="comment">// true if access to CPU counters works</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno"><a class="line" href="classPCM.html#afbb527aac9b4a15b5437bbfc3111cdeb">  982</a></span>&#160;    <span class="keyword">const</span> std::string &amp; <a class="code" href="classPCM.html#afbb527aac9b4a15b5437bbfc3111cdeb">getErrorMessage</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="keywordflow">return</span> errorMessage;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> program(<span class="keyword">const</span> <a class="code" href="classPCM.html#a88584813a3ef51376efeb22928764786">ProgramMode</a> mode_ = DEFAULT_EVENTS, <span class="keyword">const</span> <span class="keywordtype">void</span> * parameter_ = NULL); <span class="comment">// program counters and start counting</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> programServerUncoreLatencyMetrics(<span class="keywordtype">bool</span> enable_pmm);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> programServerUncorePowerMetrics(<span class="keywordtype">int</span> mc_profile, <span class="keywordtype">int</span> pcu_profile, <span class="keywordtype">int</span> * freq_bands = NULL);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <a class="code" href="classPCM.html#abebf5f22d794719dfc49155741e264e5">ErrorCode</a> programServerUncoreMemoryMetrics(<span class="keywordtype">int</span> rankA = -1, <span class="keywordtype">int</span> rankB = -1, <span class="keywordtype">bool</span> PMM = <span class="keyword">false</span>, <span class="keywordtype">bool</span> PMMMixedMode = <span class="keyword">false</span>);</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordtype">void</span> freezeServerUncoreCounters();</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordtype">void</span> unfreezeServerUncoreCounters();</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <a class="code" href="classServerUncoreCounterState.html">ServerUncoreCounterState</a> getServerUncoreCounterState(uint32 socket);</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordtype">void</span> cleanup();</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordtype">void</span> resetPMU();</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordtype">void</span> getAllCounterStates(<a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; systemState, std::vector&lt;SocketCounterState&gt; &amp; socketStates, std::vector&lt;CoreCounterState&gt; &amp; coreStates);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">void</span> getUncoreCounterStates(<a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; systemState, std::vector&lt;SocketCounterState&gt; &amp; socketStates);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="keywordtype">bool</span> isCoreOnline(int32 os_core_id) <span class="keyword">const</span>;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordtype">bool</span> isSocketOnline(int32 socket_id) <span class="keyword">const</span>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a> <a class="code" href="cpucounters_8h.html#a7a00cd524240b3c46d07ef9be7a6cdea">getSystemCounterState</a>();</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a> <a class="code" href="cpucounters_8h.html#ad3fd926e1850510a693196af34206483">getSocketCounterState</a>(uint32 socket);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a> <a class="code" href="cpucounters_8h.html#abc0a6dbd1fb8151d5095443c0916ce78">getCoreCounterState</a>(uint32 core);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    uint32 getNumCores() <span class="keyword">const</span>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    uint32 getNumOnlineCores() <span class="keyword">const</span>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    uint32 getNumSockets() <span class="keyword">const</span>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    uint32 getNumOnlineSockets() <span class="keyword">const</span>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    uint32 getThreadsPerCore() <span class="keyword">const</span>;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordtype">bool</span> getSMT() <span class="keyword">const</span>; <span class="comment">// returns true iff SMT (&quot;Hyperthreading&quot;) is on</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    uint64 getNominalFrequency() <span class="keyword">const</span>; <span class="comment">// in Hz</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    uint32 getL3ScalingFactor() <span class="keyword">const</span>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordtype">bool</span> isSomeCoreOfflined();</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    int32 getMaxCustomCoreEvents();</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01177"></a><span class="lineno"><a class="line" href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7"> 1177</a></span>&#160;    <span class="keyword">enum</span> <a class="code" href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7">SupportedCPUModels</a></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    {</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        NEHALEM_EP = 26,</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;        NEHALEM = 30,</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        ATOM = 28,</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        ATOM_2 = 53,</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        CENTERTON = 54,</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        BAYTRAIL = 55,</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        AVOTON = 77,</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        CHERRYTRAIL = 76,</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        APOLLO_LAKE = 92,</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        DENVERTON = 95,</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        CLARKDALE = 37,</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        WESTMERE_EP = 44,</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        NEHALEM_EX = 46,</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        WESTMERE_EX = 47,</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        SANDY_BRIDGE = 42,</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        JAKETOWN = 45,</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        IVY_BRIDGE = 58,</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        HASWELL = 60,</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        HASWELL_ULT = 69,</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        HASWELL_2 = 70,</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        IVYTOWN = 62,</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;        HASWELLX = 63,</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        BROADWELL = 61,</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        BROADWELL_XEON_E3 = 71,</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        BDX_DE = 86,</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        SKL_UY = 78,</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        KBL = 158,</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        KBL_1 = 142,</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        BDX = 79,</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        KNL = 87,</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        SKL = 94,</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;        SKX = 85,</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        END_OF_MODEL_LIST = 0x0ffff</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    };</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"><a class="line" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a"> 1216</a></span>&#160;    uint32 <a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (uint32)cpu_model; }</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"><a class="line" href="classPCM.html#afcf71f98767227aa64821a715bfab099"> 1220</a></span>&#160;    uint32 <a class="code" href="classPCM.html#afcf71f98767227aa64821a715bfab099">getCPUStepping</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (uint32)cpu_stepping; }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"><a class="line" href="classPCM.html#a728347cf85816c42833a1a8a1f14b861"> 1225</a></span>&#160;    int32 <a class="code" href="classPCM.html#a728347cf85816c42833a1a8a1f14b861">getThreadId</a>(uint32 os_id)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (int32)topology[os_id].thread_id; }</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"><a class="line" href="classPCM.html#a90eb072bebf4be22bce23d550983f6fe"> 1230</a></span>&#160;    int32 <a class="code" href="classPCM.html#a90eb072bebf4be22bce23d550983f6fe">getCoreId</a>(uint32 os_id)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (int32)topology[os_id].core_id; }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"><a class="line" href="classPCM.html#a2b4433865e00da98c4fa588cb1be913c"> 1235</a></span>&#160;    int32 <a class="code" href="classPCM.html#a2b4433865e00da98c4fa588cb1be913c">getTileId</a>(uint32 os_id)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (int32)topology[os_id].tile_id; }</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="classPCM.html#a015a39143b7bb87b41dc34b43a926029"> 1240</a></span>&#160;    int32 <a class="code" href="classPCM.html#a015a39143b7bb87b41dc34b43a926029">getSocketId</a>(uint32 core_id)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (int32)topology[core_id].socket; }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"><a class="line" href="classPCM.html#af0f62775b214218edf64a3f68df6c932"> 1244</a></span>&#160;    uint64 <a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        {</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            <span class="keywordflow">if</span> (num_sockets == 2)</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore.size() &amp;&amp; server_pcicfg_uncore[0].get()) ? (server_pcicfg_uncore[0]-&gt;getNumQPIPorts()) : 0;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;        }</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01270"></a><span class="lineno"><a class="line" href="classPCM.html#af47f2de0de9403d00a4dac72919c8c38"> 1270</a></span>&#160;    uint32 <a class="code" href="classPCM.html#af47f2de0de9403d00a4dac72919c8c38">getMCPerSocket</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        {</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;            <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore.size() &amp;&amp; server_pcicfg_uncore[0].get()) ? (server_pcicfg_uncore[0]-&gt;getNumMC()) : 0;</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"><a class="line" href="classPCM.html#a8509261ccf013554e4ca31f66edf65af"> 1294</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classPCM.html#a8509261ccf013554e4ca31f66edf65af">getMCChannelsPerSocket</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        {</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            <span class="keywordflow">return</span> 3;</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore.size() &amp;&amp; server_pcicfg_uncore[0].get()) ? (server_pcicfg_uncore[0]-&gt;getNumMCChannels()) : 0;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"><a class="line" href="classPCM.html#aa6ec2128018c26d8c6dc70a41dae2080"> 1320</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classPCM.html#aa6ec2128018c26d8c6dc70a41dae2080">getMCChannels</a>(uint32 socket, uint32 controller)<span class="keyword"> const</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        {</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            <span class="keywordflow">return</span> 3;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;            <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">return</span> (socket &lt; server_pcicfg_uncore.size() &amp;&amp; server_pcicfg_uncore[socket].get()) ? (server_pcicfg_uncore[socket]-&gt;getNumMCChannels(controller)) : 0;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01345"></a><span class="lineno"><a class="line" href="classPCM.html#a51b8f36a804566a381cba176107ded6d"> 1345</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="classPCM.html#a51b8f36a804566a381cba176107ded6d">getEDCChannelsPerSocket</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        {</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            <span class="keywordflow">return</span> (server_pcicfg_uncore.size() &amp;&amp; server_pcicfg_uncore[0].get()) ? (server_pcicfg_uncore[0]-&gt;getNumEDCChannels()) : 0;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        }</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01358"></a><span class="lineno"><a class="line" href="classPCM.html#a17084236c1d744a92adec4205415e0ad"> 1358</a></span>&#160;    uint32 <a class="code" href="classPCM.html#a17084236c1d744a92adec4205415e0ad">getMaxIPC</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        {</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keywordflow">case</span> DENVERTON:</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <span class="keywordflow">return</span> 3;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        <span class="keywordflow">case</span> CLARKDALE:</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">case</span> SANDY_BRIDGE:</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="keywordflow">case</span> IVY_BRIDGE:</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">case</span> HASWELL:</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        <span class="keywordflow">case</span> BROADWELL:</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">case</span> SKL:</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <span class="keywordflow">case</span> KBL:</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            <span class="keywordflow">return</span> 4;</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        <span class="keywordflow">if</span> (isAtom())</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <span class="keywordflow">return</span> 2;</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;</div><div class="line"><a name="l01393"></a><span class="lineno"><a class="line" href="classPCM.html#a9911d0d2edf17ecffd24ffce5a31a982"> 1393</a></span>&#160;    uint64 <a class="code" href="classPCM.html#a9911d0d2edf17ecffd24ffce5a31a982">getPCUFrequency</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        {</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;            <span class="keywordflow">return</span> 800000000ULL;  <span class="comment">// 800 MHz</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;            <span class="keywordflow">return</span> 1000000000ULL; <span class="comment">// 1 GHz</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            <span class="keywordflow">return</span> 1100000000ULL; <span class="comment">// 1.1 GHz</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        }</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;</div><div class="line"><a name="l01412"></a><span class="lineno"><a class="line" href="classPCM.html#a491397535c61bdc2ed5c3e8c9e229d2d"> 1412</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a491397535c61bdc2ed5c3e8c9e229d2d">isServerCPU</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">switch</span> (cpu_model)</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EP:</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">case</span> NEHALEM_EX:</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EP:</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        <span class="keywordflow">case</span> WESTMERE_EX:</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">case</span> JAKETOWN:</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">case</span> IVYTOWN:</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">case</span> HASWELLX:</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        <span class="keywordflow">case</span> BDX:</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">case</span> BDX_DE:</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <span class="keywordflow">case</span> SKX:</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">case</span> KNL:</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        };</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    }</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="classPCM.html#a33b53ec23752cb1fe3dc7e166abbe13e"> 1434</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a33b53ec23752cb1fe3dc7e166abbe13e">isClientCPU</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">return</span> !isServerCPU();</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    uint64 getTickCount(uint64 multiplier = 1000 <span class="comment">/* ms */</span>, uint32 core = 0);</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    uint64 getTickCountRDTSCP(uint64 multiplier = 1000 <span class="comment">/* ms */</span>);</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    uint64 getUncoreClocks(<span class="keyword">const</span> uint32 socket_);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;</div><div class="line"><a name="l01456"></a><span class="lineno"><a class="line" href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1"> 1456</a></span>&#160;    uint64 <a class="code" href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1">getQPILinkSpeed</a>(uint32 socketNr, uint32 linkNr)<span class="keyword"> const</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">return</span> hasPCICFGUncore() ? server_pcicfg_uncore[socketNr]-&gt;getQPILinkSpeed(linkNr) : max_qpi_speed;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    }</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;</div><div class="line"><a name="l01462"></a><span class="lineno"><a class="line" href="classPCM.html#ae933960b6244fe1d96ec4306a61c0e3a"> 1462</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classPCM.html#ae933960b6244fe1d96ec4306a61c0e3a">getJoulesPerEnergyUnit</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> joulesPerEnergyUnit; }</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01465"></a><span class="lineno"><a class="line" href="classPCM.html#a2dd024b683196cfbd6106252c47c3337"> 1465</a></span>&#160;    int32 <a class="code" href="classPCM.html#a2dd024b683196cfbd6106252c47c3337">getPackageThermalSpecPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgThermalSpecPower; }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;</div><div class="line"><a name="l01468"></a><span class="lineno"><a class="line" href="classPCM.html#ad3038bc44fb2fdd31e072b8cc8cf4b09"> 1468</a></span>&#160;    int32 <a class="code" href="classPCM.html#ad3038bc44fb2fdd31e072b8cc8cf4b09">getPackageMinimumPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgMinimumPower; }</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"><a class="line" href="classPCM.html#a51b39ec58f622cd07c07fdf03ae4f543"> 1471</a></span>&#160;    int32 <a class="code" href="classPCM.html#a51b39ec58f622cd07c07fdf03ae4f543">getPackageMaximumPower</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> pkgMaximumPower; }</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="preprocessor">    #ifndef NO_WINRING // In cases where loading the WinRing0 driver is not desirable as a fallback to MSR.sys, add -DNO_WINRING to compile command to remove ability to load driver</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> initWinRing0Lib();</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="preprocessor">    #endif // NO_WINRING</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">void</span> disableJKTWorkaround() { disable_JKT_workaround = <span class="keyword">true</span>; }</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="keyword">enum</span> PCIeEventCode</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    {</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        <span class="comment">// PCIe read events (PCI devices reading from memory - application writes to disk/network/PCIe device)</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        PCIeRdCur = 0x19E, <span class="comment">// PCIe read current (full cache line)</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        PCIeNSRd = 0x1E4,  <span class="comment">// PCIe non-snoop read (full cache line)</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="comment">// PCIe write events (PCI devices writing to memory - application reads from disk/network/PCIe device)</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        PCIeWiLF = 0x194,  <span class="comment">// PCIe Write (non-allocating) (full cache line)</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        PCIeItoM = 0x19C,  <span class="comment">// PCIe Write (allocating) (full cache line)</span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        PCIeNSWr = 0x1E5,  <span class="comment">// PCIe Non-snoop write (partial cache line)</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        PCIeNSWrF = 0x1E6, <span class="comment">// PCIe Non-snoop write (full cache line)</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="comment">// events shared by CPU and IO</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        RFO = 0x180,       <span class="comment">// Demand Data RFO; share the same code for CPU, use tid to filter PCIe only traffic</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        CRd = 0x181,       <span class="comment">// Demand Code Read</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        DRd = 0x182,       <span class="comment">// Demand Data Read</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;        PRd = 0x187,       <span class="comment">// Partial Reads (UC) (MMIO Read)</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        WiL = 0x18F,       <span class="comment">// Write Invalidate Line - partial (MMIO write), PL: Not documented in HSX/IVT</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        ItoM = 0x1C8,      <span class="comment">// Request Invalidate Line; share the same code for CPU, use tid to filter PCIe only traffic</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        SKX_RFO = 0x200,</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        SKX_CRd = 0x201,</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        SKX_DRd = 0x202,</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        SKX_PRd = 0x207,</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        SKX_WiL = 0x20F,</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        SKX_RdCur = 0x21E,</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        SKX_ItoM = 0x248,</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    };</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keyword">enum</span> ChaPipelineQueue</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        None,</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;        IRQ,</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        PRQ,</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    };</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keyword">enum</span> CBoEventTid</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    {</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        RFOtid = 0x3E,</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        ItoMtid = 0x3E,</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    };</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordtype">void</span> programPCIeEventGroup(eventGroup_t &amp;eventGroup);</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    uint64 getPCIeCounterData(<span class="keyword">const</span> uint32 socket_, <span class="keyword">const</span> uint32 ctr_);</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    <span class="keywordtype">void</span> programCbo(<span class="keyword">const</span> uint64 * events, <span class="keyword">const</span> uint32 opCode, <span class="keyword">const</span> uint32 nc_ = 0, <span class="keyword">const</span> uint32 llc_lookup_tid_filter = 0, <span class="keyword">const</span> uint32 loc = 1, <span class="keyword">const</span> uint32 rem = 1);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <a class="code" href="classSimpleCounterState.html">PCIeCounterState</a> getPCIeCounterState(<span class="keyword">const</span> uint32 socket_);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordtype">void</span> programIIOCounters(<a class="code" href="structIIOPMUCNTCTLRegister.html">IIOPMUCNTCTLRegister</a> rawEvents[4], <span class="keywordtype">int</span> IIOStack = -1);</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <a class="code" href="classSimpleCounterState.html">IIOCounterState</a> getIIOCounterState(<span class="keywordtype">int</span> socket, <span class="keywordtype">int</span> IIOStack, <span class="keywordtype">int</span> <a class="code" href="structcounter.html">counter</a>);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="keywordtype">void</span> getIIOCounterStates(<span class="keywordtype">int</span> socket, <span class="keywordtype">int</span> IIOStack, <a class="code" href="classSimpleCounterState.html">IIOCounterState</a> * result);</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    uint64 extractCoreGenCounterValue(uint64 val);</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    uint64 extractCoreFixedCounterValue(uint64 val);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    uint64 extractUncoreGenCounterValue(uint64 val);</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    uint64 extractUncoreFixedCounterValue(uint64 val);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    uint64 extractQOSMonitoring(uint64 val);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * getUArchCodename(<span class="keyword">const</span> int32 cpu_model_ = -1) <span class="keyword">const</span>;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keyword">static</span> std::string getCPUBrandString();</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;    std::string getCPUFamilyModelString();</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordtype">void</span> enableForceRTMAbortMode();</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <span class="keywordtype">bool</span> isForceRTMAbortModeEnabled() <span class="keyword">const</span>;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordtype">void</span> disableForceRTMAbortMode();</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordtype">bool</span> isForceRTMAbortModeAvailable() <span class="keyword">const</span>;</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01585"></a><span class="lineno"><a class="line" href="classPCM.html#a7e6e4c165db2cfaabaf8f5758a29ae40"> 1585</a></span>&#160;    int64 <a class="code" href="classPCM.html#a7e6e4c165db2cfaabaf8f5758a29ae40">getCPUMicrocodeLevel</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> cpu_microcode_level; }</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"><a class="line" href="classPCM.html#a1ff51f06eed09faa5c86a616a9466925"> 1588</a></span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a1ff51f06eed09faa5c86a616a9466925">isAtom</a>(<span class="keyword">const</span> int32 cpu_model_)</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    {</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">return</span> cpu_model_ == ATOM</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            || cpu_model_ == ATOM_2</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            || cpu_model_ == CENTERTON</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            || cpu_model_ == BAYTRAIL</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            || cpu_model_ == AVOTON</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            || cpu_model_ == CHERRYTRAIL</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            || cpu_model_ == APOLLO_LAKE</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            || cpu_model_ == DENVERTON</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            ;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    }</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01602"></a><span class="lineno"><a class="line" href="classPCM.html#a28d9a0ddb37cc4f87ac95b544cc36c9b"> 1602</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classPCM.html#a28d9a0ddb37cc4f87ac95b544cc36c9b">isAtom</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        <span class="keywordflow">return</span> isAtom(cpu_model);</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordtype">bool</span> packageEnergyMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    cpu_model == PCM::JAKETOWN</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                 || cpu_model == PCM::IVYTOWN</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                 || cpu_model == PCM::SANDY_BRIDGE</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                 || cpu_model == PCM::IVY_BRIDGE</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                 || cpu_model == PCM::HASWELL</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;                 || cpu_model == PCM::AVOTON</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                 || cpu_model == PCM::CHERRYTRAIL</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                 || cpu_model == PCM::BAYTRAIL</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                 || cpu_model == PCM::APOLLO_LAKE</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;                 || cpu_model == PCM::DENVERTON</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                 || cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                 || cpu_model == PCM::BROADWELL</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                 || cpu_model == PCM::BDX_DE</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                 || cpu_model == PCM::BDX</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                 || cpu_model == PCM::KNL</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                 || cpu_model == PCM::SKL</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                 || cpu_model == PCM::KBL</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                 || cpu_model == PCM::SKX</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;               );</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    }</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">bool</span> dramEnergyMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;             cpu_model == PCM::JAKETOWN</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;          || cpu_model == PCM::IVYTOWN</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          || cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;          || cpu_model == PCM::BDX_DE</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          || cpu_model == PCM::BDX</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          || cpu_model == PCM::KNL</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          || cpu_model == PCM::SKX</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          );</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    }</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordtype">bool</span> packageThermalMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <span class="keywordflow">return</span> packageEnergyMetricsAvailable();</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordtype">bool</span> outgoingQPITrafficMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        <span class="keywordflow">return</span> getQPILinksPerSocket() &gt; 0 &amp;&amp;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;            (</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                cpu_model == PCM::NEHALEM_EX</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;            ||  cpu_model == PCM::WESTMERE_EX</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            ||  cpu_model == PCM::JAKETOWN</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            ||  cpu_model == PCM::IVYTOWN</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;            ||  cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;            ||  cpu_model == PCM::BDX</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            ||  cpu_model == PCM::SKX</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            );</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    }</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordtype">bool</span> incomingQPITrafficMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="keywordflow">return</span> getQPILinksPerSocket() &gt; 0 &amp;&amp;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;            (</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                cpu_model == PCM::NEHALEM_EX</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            ||  cpu_model == PCM::WESTMERE_EX</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            ||  cpu_model == PCM::JAKETOWN</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            ||  cpu_model == PCM::IVYTOWN</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            || (cpu_model == PCM::SKX &amp;&amp; cpu_stepping &gt; 1)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;               );</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    }</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordtype">bool</span> localMemoryRequestRatioMetricAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">return</span> cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            || cpu_model == PCM::BDX</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            || cpu_model == PCM::SKX</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            ;</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    }</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordtype">bool</span> qpiUtilizationMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> outgoingQPITrafficMetricsAvailable();</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordtype">bool</span> memoryTrafficMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keywordflow">return</span> !(</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            isAtom()</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            || cpu_model == PCM::CLARKDALE</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            );</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    }</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordtype">bool</span> MCDRAMmemoryTrafficMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <span class="keywordflow">return</span> (cpu_model == PCM::KNL);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordtype">bool</span> memoryIOTrafficMetricAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            cpu_model == PCM::SANDY_BRIDGE</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            || cpu_model == PCM::IVY_BRIDGE</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            || cpu_model == PCM::HASWELL</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            || cpu_model == PCM::BROADWELL</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;            || cpu_model == PCM::SKL</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;            || cpu_model == PCM::KBL</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;            );</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordtype">bool</span> IIOEventsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            cpu_model == PCM::SKX</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        );</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    }</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordtype">bool</span> LatencyMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;            cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;            || cpu_model == PCM::BDX</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            || cpu_model == PCM::SKX</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            || cpu_model == PCM::SKL</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            );</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    }</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordtype">bool</span> DDRLatencyMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;            cpu_model == PCM::SKX</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            );</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    <span class="keywordtype">bool</span> PMMTrafficMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;            isCLX()</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    ||  isCPX()</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        );</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <span class="keywordtype">bool</span> LLCReadMissLatencyMetricsAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;               HASWELLX == cpu_model</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;            || BDX_DE == cpu_model</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;            || BDX == cpu_model</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;#ifdef PCM_ENABLE_LLCRDLAT_SKX_MP</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            || SKX == cpu_model</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;#<span class="keywordflow">else</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;            || ((SKX == cpu_model) &amp;&amp; (num_sockets == 1))</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;#endif</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;               );</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">bool</span> hasBecktonUncore()<span class="keyword"> const</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;            cpu_model == PCM::NEHALEM_EX</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            || cpu_model == PCM::WESTMERE_EX</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            );</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="keywordtype">bool</span> hasPCICFGUncore() <span class="keyword">const</span> <span class="comment">// has PCICFG uncore PMON</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    {</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            cpu_model == PCM::JAKETOWN</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            || cpu_model == PCM::IVYTOWN</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;            || cpu_model == PCM::HASWELLX</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            || cpu_model == PCM::BDX_DE</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;          ||  cpu_model == PCM::SKX</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;            || cpu_model == PCM::BDX</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            || cpu_model == PCM::KNL</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            );</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordtype">bool</span> isSkxCompatible()<span class="keyword"> const</span></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            cpu_model == PCM::SKX</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;               );</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    }</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    <span class="keywordtype">bool</span> hasUPI() <span class="keyword">const</span> <span class="comment">// Intel(r) Ultra Path Interconnect</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    {</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            cpu_model == PCM::SKX</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;               );</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> * xPI()<span class="keyword"> const</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">if</span> (hasUPI())</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            <span class="keywordflow">return</span> <span class="stringliteral">&quot;UPI&quot;</span>;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keywordflow">return</span> <span class="stringliteral">&quot;QPI&quot;</span>;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    }</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordtype">bool</span> hasCHA()<span class="keyword"> const</span></div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">return</span> (</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            cpu_model == PCM::SKX</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;               );</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    }</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="keywordtype">bool</span> supportsHLE() <span class="keyword">const</span>;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="keywordtype">bool</span> supportsRTM() <span class="keyword">const</span>;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <span class="keywordtype">bool</span> useSkylakeEvents()<span class="keyword"> const</span></div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        <span class="keywordflow">return</span>    PCM::SKL == cpu_model</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;               || PCM::KBL == cpu_model</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;               || PCM::SKX == cpu_model</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;               ;</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    }</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> getBytesPerFlit(int32 cpu_model_)</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    {</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">if</span>(cpu_model_ == PCM::SKX)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;        {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="comment">// 172 bits per UPI flit</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <span class="keywordflow">return</span> 172./8.;</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        }</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="comment">// 8 bytes per QPI flit</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordflow">return</span> 8.;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    <span class="keywordtype">double</span> getBytesPerFlit()<span class="keyword"> const</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordflow">return</span> getBytesPerFlit(cpu_model);</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    }</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> getDataBytesPerFlit(int32 cpu_model_)</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    {</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        <span class="keywordflow">if</span>(cpu_model_ == PCM::SKX)</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        {</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;            <span class="comment">// 9 UPI flits to transfer 64 bytes</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="keywordflow">return</span> 64./9.;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;        }</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        <span class="comment">// 8 bytes per QPI flit</span></div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordflow">return</span> 8.;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    }</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordtype">double</span> getDataBytesPerFlit()<span class="keyword"> const</span></div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        <span class="keywordflow">return</span> getDataBytesPerFlit(cpu_model);</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    }</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> getFlitsPerLinkCycle(int32 cpu_model_)</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    {</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">if</span>(cpu_model_ == PCM::SKX)</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        {</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;            <span class="comment">// 5 UPI flits sent every 6 link cycles</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;            <span class="keywordflow">return</span> 5./6.;</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        }</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <span class="keywordflow">return</span> 2.;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> getBytesPerLinkCycle(int32 cpu_model_)</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    {</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">return</span> getBytesPerFlit(cpu_model_) * getFlitsPerLinkCycle(cpu_model_);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    }</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="keywordtype">double</span> getBytesPerLinkCycle()<span class="keyword"> const</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        <span class="keywordflow">return</span> getBytesPerLinkCycle(cpu_model);</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    }</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> getLinkTransfersPerLinkCycle()</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    {</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="keywordflow">return</span> 8.;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    }</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordtype">double</span> getBytesPerLinkTransfer()<span class="keyword"> const</span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">return</span> getBytesPerLinkCycle() / getLinkTransfersPerLinkCycle();</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    }</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordtype">void</span> setupCustomCoreEventsForNuma(<a class="code" href="structPCM_1_1ExtendedCustomCoreEventDescription.html">PCM::ExtendedCustomCoreEventDescription</a>&amp; conf) <span class="keyword">const</span>;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">    #define PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(m) bool is##m() const { return m; }</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L2CacheHitRatioAvailable)</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L3CacheHitRatioAvailable)</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L3CacheMissesAvailable)</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L2CacheMissesAvailable)</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L2CacheHitsAvailable)</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L3CacheHitsNoSnoopAvailable)</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L3CacheHitsSnoopAvailable)</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    PCM_GENERATE_METRIC_AVAILABLE_FUNCTION(L3CacheHitsAvailable)</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <span class="preprocessor">#undef PCM_GEN_METRIC_AVAILABLE_FUNCTION</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="keywordtype">bool</span> isActiveRelativeFrequencyAvailable()<span class="keyword"> const</span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="keywordflow">return</span> !isAtom();</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    }</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    ~<a class="code" href="classPCM.html">PCM</a>();</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;};</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"><a class="line" href="classBasicCounterState.html"> 1909</a></span>&#160;<span class="keyword">class </span><a class="code" href="classBasicCounterState.html">BasicCounterState</a></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;{</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classJSONPrinter.html">JSONPrinter</a>;</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a185f850a9a753d9cf4deb8299261fd4c">getL3CacheOccupancy</a>(<span class="keyword">const</span> CounterStateType &amp; now);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a3ba7c9267c6e0f338a59defc98ae0007">getLocalMemoryBW</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a00c97b1a7d8a7125ce7fd129cddb52e8">getRemoteMemoryBW</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; now);</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; now);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a>(int32 eventCounterNr, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType&amp; now);</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a5e245473e2297272a50ca054b33c8c86">getSMICount</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    uint64 InstRetiredAny;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    uint64 CpuClkUnhaltedThread;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    uint64 CpuClkUnhaltedRef;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">// dont put any additional fields between Event 0-Event 3 because getNumberOfCustomEvents assumes there are none</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        uint64 L3Miss;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        uint64 Event0;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        uint64 ArchLLCMiss;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    };</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        uint64 L3UnsharedHit;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        uint64 Event1;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        uint64 ArchLLCRef;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        uint64 SKLL3Hit;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    };</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        uint64 L2HitM;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        uint64 Event2;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;        uint64 SKLL2Miss;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    };</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        uint64 L2Hit;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        uint64 Event3;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    };</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;    uint64 Event4, Event5, Event6, Event7;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    uint64* getEventsPtr() { <span class="keywordflow">return</span> &amp;Event0; };</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keyword">const</span> uint64* getEventsPtr()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> &amp;Event0; };</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    uint64&amp; Event(<span class="keywordtype">size_t</span> i) { <span class="keywordflow">return</span> getEventsPtr()[i]; };</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <span class="keyword">const</span> uint64&amp; Event(<span class="keywordtype">size_t</span> i)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> getEventsPtr()[i]; };</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    uint64 InvariantTSC; <span class="comment">// invariant time stamp counter</span></div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;    uint64 CStateResidency[PCM::MAX_C_STATE + 1];</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    int32 ThermalHeadroom;</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    uint64 L3Occupancy;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    uint64 MemoryBWLocal;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    uint64 MemoryBWTotal;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    uint64 SMICount;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a>() :</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        InstRetiredAny(0),</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        CpuClkUnhaltedThread(0),</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        CpuClkUnhaltedRef(0),</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        InvariantTSC(0),</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        ThermalHeadroom(PCM_INVALID_THERMAL_HEADROOM),</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        L3Occupancy(0),</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        MemoryBWLocal(0),</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        MemoryBWTotal(0),</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        SMICount(0)</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    {</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        memset(CStateResidency, 0, <span class="keyword">sizeof</span>(CStateResidency));</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        memset(getEventsPtr(), 0, <span class="keyword">sizeof</span>(uint64) * PERF_MAX_CUSTOM_COUNTERS);</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    }</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classBasicCounterState.html">BasicCounterState</a>() { }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a>( <span class="keyword">const</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a>&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a>( <a class="code" href="classBasicCounterState.html">BasicCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a> &amp; operator = ( <a class="code" href="classBasicCounterState.html">BasicCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="classBasicCounterState.html">BasicCounterState</a> &amp; operator += (<span class="keyword">const</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a> &amp; o)</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    {</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        InstRetiredAny += o.InstRetiredAny;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        CpuClkUnhaltedThread += o.CpuClkUnhaltedThread;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        CpuClkUnhaltedRef += o.CpuClkUnhaltedRef;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PERF_MAX_CUSTOM_COUNTERS; ++i)</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        {</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            Event(i) += o.Event(i);</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;        }</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        InvariantTSC += o.InvariantTSC;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= (int)PCM::MAX_C_STATE; ++i)</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            CStateResidency[i] += o.CStateResidency[i];</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        <span class="comment">// ThermalHeadroom is not accumulative</span></div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;        L3Occupancy += o.L3Occupancy;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        MemoryBWLocal += o.MemoryBWLocal;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        MemoryBWTotal += o.MemoryBWTotal;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        SMICount += o.SMICount;</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    }</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(std::shared_ptr&lt;SafeMsrHandle&gt;);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordtype">void</span> readAndAggregateTSC(std::shared_ptr&lt;SafeMsrHandle&gt;);</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;</div><div class="line"><a name="l02051"></a><span class="lineno"><a class="line" href="classBasicCounterState.html#a57d93ca07fed611468739280015a3448"> 2051</a></span>&#160;    int32 <a class="code" href="classBasicCounterState.html#a57d93ca07fed611468739280015a3448">getThermalHeadroom</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ThermalHeadroom; }</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;};</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="keyword">inline</span> uint64 RDTSC()</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;{</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        uint64 result = 0;</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        <span class="comment">// Windows</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="preprocessor">        #if _MSC_VER&gt;= 1600</span></div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        result = <span class="keyword">static_cast&lt;</span>uint64<span class="keyword">&gt;</span>(__rdtsc());</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;<span class="preprocessor">        #endif</span></div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        <span class="comment">// Linux</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        uint32 high = 0, low = 0;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;rdtsc&quot;</span> : <span class="stringliteral">&quot;=a&quot;</span> (low), <span class="stringliteral">&quot;=d&quot;</span> (high));</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        result = low + (uint64(high)&lt;&lt;32ULL);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;}</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="keyword">inline</span> uint64 RDTSCP()</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;{</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    uint64 result = 0;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    <span class="comment">// Windows</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="preprocessor">    #if _MSC_VER&gt;= 1600</span></div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Aux;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    result = __rdtscp(&amp;Aux);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="comment">// Linux and OS X</span></div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    uint32 high = 0, low = 0;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span> (</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;       <span class="stringliteral">&quot;rdtscp\n\t&quot;</span></div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;       <span class="stringliteral">&quot;mov %%edx, %0\n\t&quot;</span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;       <span class="stringliteral">&quot;mov %%eax, %1\n\t&quot;</span>:</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;       <span class="stringliteral">&quot;=r&quot;</span> (high), <span class="stringliteral">&quot;=r&quot;</span> (low) :: <span class="stringliteral">&quot;%rax&quot;</span>, <span class="stringliteral">&quot;%rcx&quot;</span>, <span class="stringliteral">&quot;%rdx&quot;</span>);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;    result = low + (uint64(high)&lt;&lt;32ULL);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;}</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02100"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336"> 2100</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;{</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keywordflow">return</span> after.QPIClocks[port] - before.QPIClocks[port];</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;}</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;int32 getThermalHeadroom(<span class="keyword">const</span> CounterStateType &amp; <span class="comment">/* before */</span>, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;{</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    <span class="keywordflow">return</span> after.getThermalHeadroom();</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;}</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02118"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3"> 2118</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;{</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;    <span class="keywordflow">return</span> after.QPIL0pTxCycles[port] - before.QPIL0pTxCycles[port];</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;}</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02129"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095"> 2129</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;{</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    <span class="keywordflow">return</span> after.QPIL1Cycles[port] - before.QPIL1Cycles[port];</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;}</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02141"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc"> 2141</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc">getNormalizedQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;{</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(port, before, after)) / double(<a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(port, before, after));</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;}</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02153"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104"> 2153</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104">getNormalizedQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;{</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(port, before, after)) / double(<a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(port, before, after));</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;}</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02164"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17"> 2164</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;{</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">return</span> after.DRAMClocks[channel] - before.DRAMClocks[channel];</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;}</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02175"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a1615063ac14cde3ace1a91bfb349f3f9"> 2175</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a1615063ac14cde3ace1a91bfb349f3f9">getMCDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;{</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    <span class="keywordflow">return</span> after.MCDRAMClocks[channel] - before.MCDRAMClocks[channel];</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;}</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02188"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f"> 2188</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a>(uint32 channel, uint32 <a class="code" href="structcounter.html">counter</a>, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;{</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keywordflow">return</span> after.MCCounter[channel][counter] - before.MCCounter[channel][counter];</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;}</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02201"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7dc8446d1f6172bdac1401e5d3ec0a4d"> 2201</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a7dc8446d1f6172bdac1401e5d3ec0a4d">getM2MCounter</a>(uint32 controller, uint32 <a class="code" href="structcounter.html">counter</a>, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;{</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordflow">return</span> after.M2MCounter[controller][counter] - before.M2MCounter[controller][counter];</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;}</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02214"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a996fd8a127111e06540302cf9ccb24a7"> 2214</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a996fd8a127111e06540302cf9ccb24a7">getEDCCounter</a>(uint32 channel, uint32 <a class="code" href="structcounter.html">counter</a>, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;{</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;MCDRAMmemoryTrafficMetricsAvailable())</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        <span class="keywordflow">return</span> after.EDCCounter[channel][counter] - before.EDCCounter[channel][counter];</div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;}</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02227"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d"> 2227</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(uint32 <a class="code" href="structcounter.html">counter</a>, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;{</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">return</span> after.PCUCounter[counter] - before.PCUCounter[counter];</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;}</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02237"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af"> 2237</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af">getPCUClocks</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;{</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(0, before, after);</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;}</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02247"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8"> 2247</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;{</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="keywordflow">return</span> after.PackageEnergyStatus - before.PackageEnergyStatus;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;}</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02257"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda"> 2257</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;{</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <span class="keywordflow">return</span> after.DRAMEnergyStatus - before.DRAMEnergyStatus;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;}</div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02267"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb"> 2267</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb">getConsumedJoules</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;{</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordflow">if</span> (!m) <span class="keywordflow">return</span> -1.;</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;    <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(before, after)) * m-&gt;<a class="code" href="classPCM.html#ae933960b6244fe1d96ec4306a61c0e3a">getJoulesPerEnergyUnit</a>();</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;}</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02280"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53"> 2280</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53">getDRAMConsumedJoules</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;{</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    <span class="keywordflow">if</span> (!m) <span class="keywordflow">return</span> -1.;</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keywordtype">double</span> dram_joules_per_energy_unit;</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;    <span class="keywordflow">if</span> (PCM::HASWELLX == m-&gt;<a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        || PCM::BDX_DE == m-&gt;<a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;        || PCM::BDX == m-&gt;<a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;        || PCM::SKX == m-&gt;<a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        || PCM::KNL == m-&gt;<a class="code" href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">getCPUModel</a>()</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        ) {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="comment">/* as described in sections 5.3.2 (DRAM_POWER_INFO) and 5.3.3 (DRAM_ENERGY_STATUS) of</span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="comment"> * Volume 2 (Registers) of</span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="comment"> * Intel Xeon E5-1600 v3 and Intel Xeon E5-2600 v3 (Haswell-EP) Datasheet (Ref 330784-001, Sept.2014)</span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="comment"> * ENERGY_UNIT for DRAM domain is fixed to 15.3 uJ for server HSX, BDW and KNL processors.</span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        dram_joules_per_energy_unit = 0.0000153;</div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment">/* for all other processors (including Haswell client/mobile SKUs) the ENERGY_UNIT for DRAM domain</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment"> * should be read from PACKAGE_POWER_SKU register (usually value around ~61uJ)</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;        dram_joules_per_energy_unit = m-&gt;<a class="code" href="classPCM.html#ae933960b6244fe1d96ec4306a61c0e3a">getJoulesPerEnergyUnit</a>();</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    }</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(before, after)) * dram_joules_per_energy_unit;</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;}</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div><div class="line"><a name="l02310"></a><span class="lineno"><a class="line" href="classUncoreCounterState.html"> 2310</a></span>&#160;<span class="keyword">class </span><a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;{</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classJSONPrinter.html">JSONPrinter</a>;</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#afba35ab2fa127ac0af819a1134711722">getBytesReadFromPMM</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#ae86f464068c1f531fd40612fa9ae0c7a">getBytesWrittenToPMM</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a8a7e839f24a02691d4b3509fc2adee51">getBytesReadFromEDC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aface6421f7c3e654bcf411abd7cea990">getBytesWrittenToEDC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType&amp; now);</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a6791e3fe842320171cbac393e55929f6">getLLCReadMissLatency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ab7b921e53cadd4e1504c90c400bd8b18">getLocalMemoryRequestRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;    uint64 UncMCFullWrites;</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;    uint64 UncMCNormalReads;</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;    uint64 UncHARequests;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;    uint64 UncHALocalRequests;</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    uint64 UncPMMWrites;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    uint64 UncPMMReads;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    uint64 UncEDCFullWrites;</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    uint64 UncEDCNormalReads;</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    uint64 UncMCIORequests;</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;    uint64 PackageEnergyStatus;</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;    uint64 DRAMEnergyStatus;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    uint64 TOROccupancyIAMiss;</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    uint64 TORInsertsIAMiss;</div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    uint64 UncClocks;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;    uint64 CStateResidency[PCM::MAX_C_STATE + 1];</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(std::shared_ptr&lt;SafeMsrHandle&gt;);</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;</div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>() :</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;        UncMCFullWrites(0),</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        UncMCNormalReads(0),</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;        UncHARequests(0),</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;        UncHALocalRequests(0),</div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        UncPMMWrites(0),</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        UncPMMReads(0),</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;        UncEDCFullWrites(0),</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        UncEDCNormalReads(0),</div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;        UncMCIORequests(0),</div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        PackageEnergyStatus(0),</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;        DRAMEnergyStatus(0),</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;        TOROccupancyIAMiss(0),</div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        TORInsertsIAMiss(0),</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        UncClocks(0)</div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;    {</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        memset(CStateResidency, 0, <span class="keyword">sizeof</span>(CStateResidency));</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    }</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <span class="keyword">virtual</span> ~<a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>() { }</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>( <span class="keyword">const</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>( <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a> &amp; operator = ( <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a> &amp; operator += (<span class="keyword">const</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a> &amp; o)</div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;    {</div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;        UncMCFullWrites += o.UncMCFullWrites;</div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;        UncMCNormalReads += o.UncMCNormalReads;</div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;        UncHARequests += o.UncHARequests;</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;        UncHALocalRequests += o.UncHALocalRequests;</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;        UncPMMReads += o.UncPMMReads;</div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;        UncPMMWrites += o.UncPMMWrites;</div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;        UncEDCFullWrites += o.UncEDCFullWrites;</div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;        UncEDCNormalReads += o.UncEDCNormalReads;</div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;        UncMCIORequests += o.UncMCIORequests;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;        PackageEnergyStatus += o.PackageEnergyStatus;</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        DRAMEnergyStatus += o.DRAMEnergyStatus;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        TOROccupancyIAMiss += o.TOROccupancyIAMiss;</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        TORInsertsIAMiss += o.TORInsertsIAMiss;</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        UncClocks += o.UncClocks;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= (int)PCM::MAX_C_STATE; ++i)</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;            CStateResidency[i] += o.CStateResidency[i];</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    }</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;};</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div><div class="line"><a name="l02409"></a><span class="lineno"><a class="line" href="classServerUncoreCounterState.html"> 2409</a></span>&#160;<span class="keyword">class </span><a class="code" href="classServerUncoreCounterState.html">ServerUncoreCounterState</a> : <span class="keyword">public</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;{</div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;    <span class="keyword">enum</span> {</div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        maxControllers = 2,</div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        maxChannels = 8,</div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        maxXPILinks = 6,</div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        maxCounters = 4</div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;    };</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;    std::array&lt;uint64, maxXPILinks&gt; QPIClocks, QPIL0pTxCycles, QPIL1Cycles;</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    std::array&lt;uint64, maxChannels&gt; DRAMClocks;</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    std::array&lt;uint64, maxChannels&gt; MCDRAMClocks;</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    std::array&lt;std::array&lt;uint64, maxCounters&gt;, maxChannels&gt; MCCounter; <span class="comment">// channel X counter</span></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    std::array&lt;std::array&lt;uint64, maxCounters&gt;, maxControllers&gt; M2MCounter; <span class="comment">// M2M/iMC boxes x counter</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    std::array&lt;std::array&lt;uint64, maxCounters&gt;, maxChannels&gt; EDCCounter; <span class="comment">// EDC controller X counter</span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    std::array&lt;uint64, maxCounters&gt; PCUCounter;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    int32 PackageThermalHeadroom;</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    uint64 InvariantTSC;    <span class="comment">// invariant time stamp counter</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a>(uint32 port, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a1615063ac14cde3ace1a91bfb349f3f9">getMCDRAMClocks</a>(uint32 channel, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a>(uint32 channel, uint32 <a class="code" href="structcounter.html">counter</a>, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a7dc8446d1f6172bdac1401e5d3ec0a4d">getM2MCounter</a>(uint32 controller, uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a996fd8a127111e06540302cf9ccb24a7">getEDCCounter</a>(uint32 channel, uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a>(uint32 counter, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after);</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02456"></a><span class="lineno"><a class="line" href="classServerUncoreCounterState.html#ac02003a3242a83278e429f34707e4966"> 2456</a></span>&#160;    int32 <a class="code" href="classServerUncoreCounterState.html#ac02003a3242a83278e429f34707e4966">getPackageThermalHeadroom</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> PackageThermalHeadroom; }</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    <a class="code" href="classServerUncoreCounterState.html">ServerUncoreCounterState</a>() :</div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;        QPIClocks{}, QPIL0pTxCycles{}, QPIL1Cycles{},</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;        DRAMClocks{},</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;        MCDRAMClocks{},</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;        MCCounter{},</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        M2MCounter{},</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;        EDCCounter{},</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;        PCUCounter{},</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        PackageThermalHeadroom(0),</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        InvariantTSC(0)</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    {</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    }</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;};</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"><a class="line" href="classCoreCounterState.html"> 2472</a></span>&#160;<span class="keyword">class </span><a class="code" href="classCoreCounterState.html">CoreCounterState</a> : <span class="keyword">public</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;{</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a>( <span class="keyword">const</span> <a class="code" href="classCoreCounterState.html">CoreCounterState</a>&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a>( <a class="code" href="classCoreCounterState.html">CoreCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    <a class="code" href="classCoreCounterState.html">CoreCounterState</a> &amp; operator= ( <a class="code" href="classCoreCounterState.html">CoreCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;};</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;</div><div class="line"><a name="l02484"></a><span class="lineno"><a class="line" href="classSocketCounterState.html"> 2484</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSocketCounterState.html">SocketCounterState</a> : <span class="keyword">public</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a>, <span class="keyword">public</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;{</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(std::shared_ptr&lt;SafeMsrHandle&gt; handle)</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    {</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        BasicCounterState::readAndAggregate(handle);</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        UncoreCounterState::readAndAggregate(handle);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    }</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp; operator += ( <span class="keyword">const</span> <a class="code" href="classBasicCounterState.html">BasicCounterState</a>&amp; ccs )</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    {</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        BasicCounterState::operator += ( ccs );</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    }</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp; operator += ( <span class="keyword">const</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp; ucs )</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    {</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        UncoreCounterState::operator += ( ucs );</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    }</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a>( <span class="keyword">const</span> <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a>( <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a> &amp; operator = ( <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;    <a class="code" href="classSocketCounterState.html">SocketCounterState</a> &amp; operator = ( <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp;&amp; ucs ) {</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        UncoreCounterState::operator = ( std::move(ucs) );</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;    }</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;};</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div><div class="line"><a name="l02522"></a><span class="lineno"><a class="line" href="classSystemCounterState.html"> 2522</a></span>&#160;<span class="keyword">class </span><a class="code" href="classSystemCounterState.html">SystemCounterState</a> : <span class="keyword">public</span> <a class="code" href="classSocketCounterState.html">SocketCounterState</a></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;{</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span><a class="code" href="classPCM.html">PCM</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; incomingQPIPackets; <span class="comment">// each 64 byte</span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; outgoingQPIFlits; <span class="comment">// idle or data/non-data flits depending on the architecture</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    std::vector&lt;std::vector&lt;uint64&gt; &gt; TxL0Cycles;</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    uint64 uncoreTSC;</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="keyword">protected</span>:</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordtype">void</span> readAndAggregate(std::shared_ptr&lt;SafeMsrHandle&gt; handle)</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    {</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        BasicCounterState::readAndAggregate(handle);</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        UncoreCounterState::readAndAggregate(handle);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;    }</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now);</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keyword">friend</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after);</div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <span class="keyword">friend</span> uint64 <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;</div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a>() :</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;        uncoreTSC(0)</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    {</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;        <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        incomingQPIPackets.resize(m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>(),</div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                                  std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>(), 0));</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        outgoingQPIFlits.resize(m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>(),</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                                    std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>(), 0));</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        TxL0Cycles.resize(m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>(),</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                                    std::vector&lt;uint64&gt;((uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>(), 0));</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a>( <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a>&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a>( <a class="code" href="classSystemCounterState.html">SystemCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; operator = ( <a class="code" href="classSystemCounterState.html">SystemCounterState</a>&amp;&amp; ) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; operator += ( <span class="keyword">const</span> <a class="code" href="classSocketCounterState.html">SocketCounterState</a>&amp; scs )</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;    {</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;        BasicCounterState::operator += ( scs );</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        UncoreCounterState::operator += ( scs );</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;    }</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; operator += ( <span class="keyword">const</span> <a class="code" href="classUncoreCounterState.html">UncoreCounterState</a>&amp; ucs )</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;    {</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        UncoreCounterState::operator += ( ucs );</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    }</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;};</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;PCM_API <a class="code" href="classSystemCounterState.html">SystemCounterState</a> <a class="code" href="cpucounters_8h.html#a7a00cd524240b3c46d07ef9be7a6cdea">getSystemCounterState</a>();</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;PCM_API <a class="code" href="classSocketCounterState.html">SocketCounterState</a> <a class="code" href="cpucounters_8h.html#ad3fd926e1850510a693196af34206483">getSocketCounterState</a>(uint32 socket);</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;PCM_API <a class="code" href="classCoreCounterState.html">CoreCounterState</a> <a class="code" href="cpucounters_8h.html#abc0a6dbd1fb8151d5095443c0916ce78">getCoreCounterState</a>(uint32 core);</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02614"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22"> 2614</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// instructions per cycle</span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;{</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordflow">if</span> (clocks != 0)</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;        <span class="keywordflow">return</span> double(after.InstRetiredAny - before.InstRetiredAny) / double(clocks);</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;}</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02630"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771"> 2630</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// instructions</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;{</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    <span class="keywordflow">return</span> after.InstRetiredAny - before.InstRetiredAny;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;}</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02642"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0"> 2642</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// usage</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;{</div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0)</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        <span class="keywordflow">return</span> double(after.InstRetiredAny - before.InstRetiredAny) / double(timer_clocks);</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;}</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02656"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#afced47e4bb3712da79dc64cb16ac335a"> 2656</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a>(<span class="keyword">const</span> CounterStateType &amp; now) <span class="comment">// instructions</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;{</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <span class="keywordflow">return</span> now.InstRetiredAny;</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;}</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02679"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4"> 2679</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// clocks</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;{</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="keywordflow">return</span> after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;}</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02695"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326"> 2695</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// clocks</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;{</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    <span class="keywordflow">return</span> after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;}</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02708"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#adc17d576ecaf02cf98cebc86329bf2a1"> 2708</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a>(<span class="keyword">const</span> CounterStateType &amp; now) <span class="comment">// clocks</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;{</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;    <span class="keywordflow">return</span> now.CpuClkUnhaltedThread;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;}</div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;</div><div class="line"><a name="l02721"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568"> 2721</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568">getCoreIPC</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after) <span class="comment">// instructions per cycle</span></div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;{</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="keywordtype">double</span> ipc = <a class="code" href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a>(before, after);</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="keywordflow">if</span> (ipc &gt;= 0. &amp;&amp; m &amp;&amp; (m-&gt;<a class="code" href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">getNumCores</a>() == m-&gt;<a class="code" href="classPCM.html#a30210eb2ddc9eee6bfe1db4b159f922b">getNumOnlineCores</a>()))</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;        <span class="keywordflow">return</span> ipc * double(m-&gt;<a class="code" href="classPCM.html#a850a9aeee162133adbc4b5d8df679639">getThreadsPerCore</a>());</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;}</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02739"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1"> 2739</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1">getTotalExecUsage</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after) <span class="comment">// usage</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;{</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    <span class="keywordtype">double</span> usage = <a class="code" href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a>(before, after);</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    <span class="keywordflow">if</span> (usage &gt;= 0. &amp;&amp; m &amp;&amp; (m-&gt;<a class="code" href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">getNumCores</a>() == m-&gt;<a class="code" href="classPCM.html#a30210eb2ddc9eee6bfe1db4b159f922b">getNumOnlineCores</a>()))</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;        <span class="keywordflow">return</span> usage * double(m-&gt;<a class="code" href="classPCM.html#a850a9aeee162133adbc4b5d8df679639">getThreadsPerCore</a>());</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;}</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02755"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c"> 2755</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// in Hz</span></div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;{</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0 &amp;&amp; m)</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        <span class="keywordflow">return</span> double(m-&gt;<a class="code" href="classPCM.html#a83cd795814da47148632b24e485e6075">getNominalFrequency</a>()) * <span class="keywordtype">double</span>(clocks) / double(timer_clocks);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;}</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02772"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1"> 2772</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// in Hz</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;{</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;    int64 ref_clocks = after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    <span class="keywordflow">if</span> (ref_clocks != 0 &amp;&amp; m)</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordflow">return</span> double(m-&gt;<a class="code" href="classPCM.html#a83cd795814da47148632b24e485e6075">getNominalFrequency</a>()) * <span class="keywordtype">double</span>(clocks) / double(ref_clocks);</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;}</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02789"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242"> 2789</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// fraction of nominal frequency</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;{</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    int64 timer_clocks = after.InvariantTSC - before.InvariantTSC;</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">if</span> (timer_clocks != 0)</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;        <span class="keywordflow">return</span> double(clocks) / double(timer_clocks);</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;}</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02805"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633"> 2805</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after) <span class="comment">// fraction of nominal frequency</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;{</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isActiveRelativeFrequencyAvailable()) <span class="keywordflow">return</span> -1.;</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    int64 clocks = after.CpuClkUnhaltedThread - before.CpuClkUnhaltedThread;</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    int64 ref_clocks = after.CpuClkUnhaltedRef - before.CpuClkUnhaltedRef;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    <span class="keywordflow">if</span> (ref_clocks != 0)</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <span class="keywordflow">return</span> double(clocks) / double(ref_clocks);</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;}</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02823"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518"> 2823</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType&amp; before, <span class="keyword">const</span> CounterStateType&amp; after) <span class="comment">// 0.0 - 1.0</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;{</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL2CacheHitRatioAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> hits = <a class="code" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a>(before, after);</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> misses = <a class="code" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a>(before, after);</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    <span class="keywordflow">return</span> double(hits) / double(hits + misses);</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;}</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02839"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885"> 2839</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a>(<span class="keyword">const</span> CounterStateType&amp; before, <span class="keyword">const</span> CounterStateType&amp; after) <span class="comment">// 0.0 - 1.0</span></div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;{</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL3CacheHitRatioAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> hits = <a class="code" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a>(before, after);</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> misses = <a class="code" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a>(before, after);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    <span class="keywordflow">return</span> double(hits) / double(hits + misses);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02855"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343"> 2855</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;{</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL3CacheMissesAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <span class="keywordflow">return</span> after.L3Miss - before.L3Miss;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;}</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02869"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58"> 2869</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;{</div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keyword">auto</span> pcm = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keywordflow">if</span> (pcm-&gt;isL2CacheMissesAvailable() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    <span class="keywordflow">if</span> (pcm-&gt;useSkylakeEvents()) {</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;        <span class="keywordflow">return</span> after.SKLL2Miss - before.SKLL2Miss;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    }</div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="keywordflow">if</span> (pcm-&gt;isAtom() || pcm-&gt;getCPUModel() == PCM::KNL)</div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    {</div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="keywordflow">return</span> after.ArchLLCMiss - before.ArchLLCMiss;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    }</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    uint64 L3Miss = after.L3Miss - before.L3Miss;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    uint64 L3UnsharedHit = after.L3UnsharedHit - before.L3UnsharedHit;</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    uint64 L2HitM = after.L2HitM - before.L2HitM;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <span class="keywordflow">return</span> L2HitM + L3UnsharedHit + L3Miss;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;}</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02894"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61"> 2894</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;{</div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keyword">auto</span> pcm = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    <span class="keywordflow">if</span> (pcm-&gt;isL2CacheHitsAvailable() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;    <span class="keywordflow">if</span> (pcm-&gt;isAtom() || pcm-&gt;getCPUModel() == PCM::KNL)</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    {</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;        uint64 L2Miss = after.ArchLLCMiss - before.ArchLLCMiss;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;        uint64 L2Ref = after.ArchLLCRef - before.ArchLLCRef;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;        <span class="keywordflow">return</span> L2Ref - L2Miss;</div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    }</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="keywordflow">return</span> after.L2Hit - before.L2Hit;</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;}</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02911"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a185f850a9a753d9cf4deb8299261fd4c"> 2911</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a185f850a9a753d9cf4deb8299261fd4c">getL3CacheOccupancy</a>(<span class="keyword">const</span> CounterStateType &amp; now)</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;{</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#a6a6580b296a5a0236c9e00956988c0fc">L3CacheOccupancyMetricAvailable</a>() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;    <span class="keywordflow">return</span> now.L3Occupancy;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;}</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02920"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a3ba7c9267c6e0f338a59defc98ae0007"> 2920</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a3ba7c9267c6e0f338a59defc98ae0007">getLocalMemoryBW</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;{</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#af0648834f063a6bd2ea88c61a2ba286d">CoreLocalMemoryBWMetricAvailable</a>() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    <span class="keywordflow">return</span> after.MemoryBWLocal - before.MemoryBWLocal;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;}</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02930"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a00c97b1a7d8a7125ce7fd129cddb52e8"> 2930</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a00c97b1a7d8a7125ce7fd129cddb52e8">getRemoteMemoryBW</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;{</div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;<a class="code" href="classPCM.html#a9b2b73d2af7c5a851e5c43df37d7fdb2">CoreRemoteMemoryBWMetricAvailable</a>() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    <span class="keyword">const</span> uint64 total = after.MemoryBWTotal - before.MemoryBWTotal;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="keyword">const</span> uint64 local = <a class="code" href="cpucounters_8h.html#a3ba7c9267c6e0f338a59defc98ae0007">getLocalMemoryBW</a>(before, after);</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    <span class="keywordflow">if</span> (total &gt; local)</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="keywordflow">return</span> total - local;</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;}</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02949"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2"> 2949</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;{</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL3CacheHitsNoSnoopAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;    <span class="keywordflow">return</span> after.L3UnsharedHit - before.L3UnsharedHit;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;}</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02963"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f"> 2963</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;{</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL3CacheHitsSnoopAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;useSkylakeEvents()) {</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;        <span class="keywordflow">return</span> after.SKLL3Hit - before.SKLL3Hit;</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    }</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    <span class="keywordflow">return</span> after.L2HitM - before.L2HitM;</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;}</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02981"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6"> 2981</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;{</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;isL3CacheHitsAvailable()) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a>(before, after) + <a class="code" href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a>(before, after);</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;}</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l02996"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9"> 2996</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;{</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;    <span class="keywordflow">return</span> after.InvariantTSC - before.InvariantTSC;</div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;}</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03009"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce"> 3009</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;{</div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tsc = double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after));</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">if</span> (state == 0) <span class="keywordflow">return</span> double(<a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(before, after)) / tsc;</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;    <span class="keywordflow">if</span> (state == 1)</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;    {</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;        <span class="keywordtype">double</span> result = 1.0 - double(<a class="code" href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a>(before, after)) / tsc; <span class="comment">// 1.0 - cC0</span></div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt;= PCM::MAX_C_STATE; ++i)</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">isCoreCStateResidencySupported</a>(state))</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;                result -= (after.BasicCounterState::CStateResidency[i] - before.BasicCounterState::CStateResidency[i]) / tsc;</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0.) result = 0.;       <span class="comment">// fix counter dissynchronization</span></div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result &gt; 1.) result = 1.;  <span class="comment">// fix counter dissynchronization</span></div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    }</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="keywordflow">return</span> (after.BasicCounterState::CStateResidency[state] - before.BasicCounterState::CStateResidency[state]) / tsc;</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;}</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03038"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a98f62d772883ce741ba7065bada41d11"> 3038</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType&amp; now)</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;{</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;    <span class="keywordflow">if</span> (state == 0) <span class="keywordflow">return</span> now.CpuClkUnhaltedRef;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;    <span class="keywordflow">return</span> now.BasicCounterState::CStateResidency[state];</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;}</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03053"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38"> 3053</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;{</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> tsc = double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after));</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    <span class="keywordflow">if</span> (state == 0)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    {</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;        <span class="keywordtype">double</span> result = 1.0;</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= PCM::MAX_C_STATE; ++i)</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            <span class="keywordflow">if</span> (m-&gt;<a class="code" href="classPCM.html#aad05d8a2f383ad41d25892175373b613">isPackageCStateResidencySupported</a>(state))</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;                result -= (after.UncoreCounterState::CStateResidency[i] - before.UncoreCounterState::CStateResidency[i]) / tsc;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="keywordflow">if</span> (result &lt; 0.) result = 0.;       <span class="comment">// fix counter dissynchronization</span></div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (result &gt; 1.) result = 1.;  <span class="comment">// fix counter dissynchronization</span></div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    }</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keywordflow">return</span> double(after.UncoreCounterState::CStateResidency[state] - before.UncoreCounterState::CStateResidency[state]) / tsc;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;}</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03079"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#acc0bf1bfe515f9e6b7003ee87ba10eb0"> 3079</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a>(<span class="keywordtype">int</span> state, <span class="keyword">const</span> CounterStateType&amp; now)</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;{</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    <span class="keywordflow">return</span> now.UncoreCounterState::CStateResidency[state];</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;}</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03091"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f"> 3091</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;{</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;memoryTrafficMetricsAvailable())</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="keywordflow">return</span> (after.UncMCNormalReads - before.UncMCNormalReads) * 64;</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;}</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03105"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1"> 3105</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;{</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;memoryTrafficMetricsAvailable())</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        <span class="keywordflow">return</span> (after.UncMCFullWrites - before.UncMCFullWrites) * 64;</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;}</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03119"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#afba35ab2fa127ac0af819a1134711722"> 3119</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#afba35ab2fa127ac0af819a1134711722">getBytesReadFromPMM</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;{</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;PMMTrafficMetricsAvailable())</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <span class="keywordflow">return</span> (after.UncPMMReads - before.UncPMMReads) * 64;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;}</div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03133"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ae86f464068c1f531fd40612fa9ae0c7a"> 3133</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#ae86f464068c1f531fd40612fa9ae0c7a">getBytesWrittenToPMM</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;{</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;PMMTrafficMetricsAvailable())</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;        <span class="keywordflow">return</span> (after.UncPMMWrites - before.UncPMMWrites) * 64;</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;}</div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;</div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03147"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a8a7e839f24a02691d4b3509fc2adee51"> 3147</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a8a7e839f24a02691d4b3509fc2adee51">getBytesReadFromEDC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;{</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;MCDRAMmemoryTrafficMetricsAvailable())</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        <span class="keywordflow">return</span> (after.UncEDCNormalReads - before.UncEDCNormalReads) * 64;</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;}</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03161"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aface6421f7c3e654bcf411abd7cea990"> 3161</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#aface6421f7c3e654bcf411abd7cea990">getBytesWrittenToEDC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;{</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;MCDRAMmemoryTrafficMetricsAvailable())</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;        <span class="keywordflow">return</span> (after.UncEDCFullWrites - before.UncEDCFullWrites) * 64;</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;}</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03176"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d"> 3176</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;{</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;memoryIOTrafficMetricAvailable())</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <span class="keywordflow">return</span> (after.UncMCIORequests - before.UncMCIORequests) * 64;</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;}</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03190"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a5e245473e2297272a50ca054b33c8c86"> 3190</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#a5e245473e2297272a50ca054b33c8c86">getSMICount</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;{</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <span class="keywordflow">return</span> after.SMICount - before.SMICount;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;}</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03205"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e"> 3205</a></span>&#160;uint64 <a class="code" href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a>(int32 eventCounterNr, <span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;{</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;    <span class="keywordflow">return</span> after.Event(eventCounterNr) - before.Event(eventCounterNr);</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;}</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03220"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3"> 3220</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;{</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;incomingQPITrafficMetricsAvailable()) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    uint64 b = before.incomingQPIPackets[socketNr][linkNr];</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    uint64 a = after.incomingQPIPackets[socketNr][linkNr];</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <span class="comment">// prevent overflows due to counter dissynchronisation</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;    <span class="keywordflow">return</span> (a &gt; b) ? (64 * (a - b)) : 0;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;}</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;</div><div class="line"><a name="l03239"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c"> 3239</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c">getIncomingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;{</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;    <span class="keywordflow">if</span> (!(m-&gt;qpiUtilizationMetricsAvailable())) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> bytes = (double)<a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(socketNr, linkNr, before, after);</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    <span class="keyword">const</span> uint64 max_speed = m-&gt;<a class="code" href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1">getQPILinkSpeed</a>(socketNr, linkNr);</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> max_bytes = (double)(<span class="keywordtype">double</span>(max_speed) * double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after) / <span class="keywordtype">double</span>(m-&gt;<a class="code" href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">getNumCores</a>())) / double(m-&gt;<a class="code" href="classPCM.html#a83cd795814da47148632b24e485e6075">getNominalFrequency</a>()));</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;    <span class="keywordflow">return</span> bytes / max_bytes;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;}</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div><div class="line"><a name="l03260"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773"> 3260</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;{</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;    <span class="keywordflow">if</span> (m-&gt;outgoingQPITrafficMetricsAvailable() == <span class="keyword">false</span>) <span class="keywordflow">return</span> 0.;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="keywordflow">if</span> (m-&gt;hasBecktonUncore())</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    {</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        <span class="keyword">const</span> uint64 b = before.outgoingQPIFlits[socketNr][linkNr]; <span class="comment">// idle flits</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;        <span class="keyword">const</span> uint64 a = after.outgoingQPIFlits[socketNr][linkNr];  <span class="comment">// idle flits</span></div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;        <span class="comment">// prevent overflows due to counter dissynchronisation</span></div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> idle_flits = (double)((a &gt; b) ? (a - b) : 0);</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;        <span class="keyword">const</span> uint64 bTSC = before.uncoreTSC;</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        <span class="keyword">const</span> uint64 aTSC = after.uncoreTSC;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> tsc = (double)((aTSC &gt; bTSC) ? (aTSC - bTSC) : 0);</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        <span class="keywordflow">if</span> (idle_flits &gt;= tsc) <span class="keywordflow">return</span> 0.; <span class="comment">// prevent oveflows due to potential counter dissynchronization</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;        <span class="keywordflow">return</span> (1. - (idle_flits / tsc));</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m-&gt;hasPCICFGUncore())</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;    {</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <span class="keyword">const</span> uint64 b = before.outgoingQPIFlits[socketNr][linkNr]; <span class="comment">// data + non-data flits or idle (null) flits</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;        <span class="keyword">const</span> uint64 a = after.outgoingQPIFlits[socketNr][linkNr]; <span class="comment">// data + non-data flits or idle (null) flits</span></div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;        <span class="comment">// prevent overflows due to counter dissynchronisation</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;        <span class="keywordtype">double</span> flits = (double)((a &gt; b) ? (a - b) : 0);</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> max_flits = ((double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after)) * double(m-&gt;<a class="code" href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1">getQPILinkSpeed</a>(socketNr, linkNr)) / m-&gt;getBytesPerFlit()) / <span class="keywordtype">double</span>(m-&gt;<a class="code" href="classPCM.html#a83cd795814da47148632b24e485e6075">getNominalFrequency</a>())) / double(m-&gt;<a class="code" href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">getNumCores</a>());</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        <span class="keywordflow">if</span>(m-&gt;hasUPI())</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;        {</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;            flits = flits/3.;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        }</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;        <span class="keywordflow">if</span> (flits &gt; max_flits) <span class="keywordflow">return</span> 1.; <span class="comment">// prevent oveflows due to potential counter dissynchronization</span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;        <span class="keywordflow">return</span> (flits / max_flits);</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    }</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;}</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;</div><div class="line"><a name="l03306"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23"> 3306</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;{</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <span class="keywordflow">if</span> (!(m-&gt;outgoingQPITrafficMetricsAvailable())) <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> util = <a class="code" href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a>(socketNr, linkNr, before, after);</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> max_bytes = (double(m-&gt;<a class="code" href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1">getQPILinkSpeed</a>(socketNr, linkNr)) * <span class="keywordtype">double</span>(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after) / double(m-&gt;<a class="code" href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">getNumCores</a>())) / double(m-&gt;<a class="code" href="classPCM.html#a83cd795814da47148632b24e485e6075">getNominalFrequency</a>()));</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    <span class="keywordflow">return</span> (uint64)(max_bytes * util);</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;}</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div><div class="line"><a name="l03326"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404"> 3326</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;{</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>();</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>();</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    uint64 sum = 0;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;</div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;            sum += <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(s, q, before, after);</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;}</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;</div><div class="line"><a name="l03348"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370"> 3348</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370">getAllOutgoingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;{</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>();</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>();</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;    uint64 sum = 0;</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;        <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;            sum += <a class="code" href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a>(s, q, before, after);</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;}</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div><div class="line"><a name="l03372"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a42d6a119a26ea41c40d5585356d832ca"> 3372</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(uint32 socketNr, uint32 linkNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;{</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;incomingQPITrafficMetricsAvailable())</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        <span class="keywordflow">return</span> 64 * now.incomingQPIPackets[socketNr][linkNr];</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;    <span class="keywordflow">return</span> 0ULL;</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;}</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;</div><div class="line"><a name="l03387"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd"> 3387</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a>(uint32 socketNr, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;{</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;    <span class="keyword">const</span> uint32 qpiLinks = (uint32)m-&gt;<a class="code" href="classPCM.html#af0f62775b214218edf64a3f68df6c932">getQPILinksPerSocket</a>();</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    uint64 sum = 0;</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;    <span class="keywordflow">for</span> (uint32 q = 0; q &lt; qpiLinks; ++q)</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;        sum += <a class="code" href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a>(socketNr, q, now);</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;}</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;</div><div class="line"><a name="l03406"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ad21f46c2ea28e3ca5c074fc7749b7395"> 3406</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; now)</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;{</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    <a class="code" href="classPCM.html">PCM</a> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    <span class="keyword">const</span> uint32 ns = m-&gt;<a class="code" href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">getNumSockets</a>();</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;    uint64 sum = 0;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;    <span class="keywordflow">for</span> (uint32 s = 0; s &lt; ns; ++s)</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        sum += <a class="code" href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a>(s, now);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <span class="keywordflow">return</span> sum;</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;}</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;</div><div class="line"><a name="l03427"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49"> 3427</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49">getQPItoMCTrafficRatio</a>(<span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; before, <span class="keyword">const</span> <a class="code" href="classSystemCounterState.html">SystemCounterState</a> &amp; after)</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;{</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keyword">const</span> uint64 totalQPI = <a class="code" href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a>(before, after);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;    uint64 memTraffic = <a class="code" href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a>(before, after) + <a class="code" href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a>(before, after);</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;PMMTrafficMetricsAvailable())</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    {</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        memTraffic += <a class="code" href="cpucounters_8h.html#afba35ab2fa127ac0af819a1134711722">getBytesReadFromPMM</a>(before, after) + <a class="code" href="cpucounters_8h.html#ae86f464068c1f531fd40612fa9ae0c7a">getBytesWrittenToPMM</a>(before, after);</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    }</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    <span class="keywordflow">return</span> double(totalQPI) / double(memTraffic);</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;}</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03445"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#ab7b921e53cadd4e1504c90c400bd8b18"> 3445</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#ab7b921e53cadd4e1504c90c400bd8b18">getLocalMemoryRequestRatio</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;{</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;localMemoryRequestRatioMetricAvailable() == <span class="keyword">false</span>) <span class="keywordflow">return</span> -1.;</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> all = after.UncHARequests - before.UncHARequests;</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> local = after.UncHALocalRequests - before.UncHALocalRequests;</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;    <span class="comment">// std::cout &lt;&lt; &quot;DEBUG &quot;&lt;&lt; 64*all/1e6 &lt;&lt; &quot; &quot; &lt;&lt; 64*local/1e6 &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="keywordflow">return</span> double(local)/double(all);</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;}</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterType&gt;</div><div class="line"><a name="l03458"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a74fe887976e82116d27513e162a9a089"> 3458</a></span>&#160;<span class="keyword">inline</span> uint64 <a class="code" href="cpucounters_8h.html#a74fe887976e82116d27513e162a9a089">getNumberOfEvents</a>(<span class="keyword">const</span> CounterType &amp; before, <span class="keyword">const</span> CounterType &amp; after)</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;{</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordflow">return</span> after.data - before.data;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;}</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> CounterStateType&gt;</div><div class="line"><a name="l03465"></a><span class="lineno"><a class="line" href="cpucounters_8h.html#a6791e3fe842320171cbac393e55929f6"> 3465</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="cpucounters_8h.html#a6791e3fe842320171cbac393e55929f6">getLLCReadMissLatency</a>(<span class="keyword">const</span> CounterStateType &amp; before, <span class="keyword">const</span> CounterStateType &amp; after)</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;{</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>()-&gt;LLCReadMissLatencyMetricsAvailable() == <span class="keyword">false</span>) <span class="keywordflow">return</span> -1.;</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> occupancy = double(after.TOROccupancyIAMiss) - double(before.TOROccupancyIAMiss);</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> inserts = double(after.TORInsertsIAMiss) - double(before.TORInsertsIAMiss);</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> unc_clocks = double(after.UncClocks) - double(before.UncClocks);</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <span class="keyword">auto</span> * m = <a class="code" href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a>();</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> seconds = double(<a class="code" href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a>(before, after)) / double(m-&gt;getNumCores()/m-&gt;getNumSockets()) / <span class="keywordtype">double</span>(m-&gt;getNominalFrequency());</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    <span class="keywordflow">return</span> 1e9*seconds*(occupancy/inserts)/unc_clocks;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;}</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="cpucounters_8h_html_a0ea54e2a783ce71cef06350aed099104"><div class="ttname"><a href="cpucounters_8h.html#a0ea54e2a783ce71cef06350aed099104">getNormalizedQPIL1Cycles</a></div><div class="ttdeci">double getNormalizedQPIL1Cycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the ratio of QPI cycles in power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2153</div></div>
<div class="ttc" id="classSocket_html"><div class="ttname"><a href="classSocket.html">Socket</a></div><div class="ttdef"><b>Definition:</b> topology.h:286</div></div>
<div class="ttc" id="classPCM_html_afbb527aac9b4a15b5437bbfc3111cdeb"><div class="ttname"><a href="classPCM.html#afbb527aac9b4a15b5437bbfc3111cdeb">PCM::getErrorMessage</a></div><div class="ttdeci">const std::string &amp; getErrorMessage() const</div><div class="ttdoc">Returns the error message. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:982</div></div>
<div class="ttc" id="cpucounters_8h_html_ae6e948c5ad7859e3760336aa02f466bd"><div class="ttname"><a href="cpucounters_8h.html#ae6e948c5ad7859e3760336aa02f466bd">getSocketIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getSocketIncomingQPILinkBytes(uint32 socketNr, const SystemCounterState &amp;now)</div><div class="ttdoc">Get estimation of total QPI data traffic for this socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3387</div></div>
<div class="ttc" id="structT_html"><div class="ttname"><a href="structT.html">T</a></div><div class="ttdef"><b>Definition:</b> memoptest.cpp:34</div></div>
<div class="ttc" id="cpucounters_8h_html_af7d9ba0936d7c305d0cc6c2db296a336"><div class="ttname"><a href="cpucounters_8h.html#af7d9ba0936d7c305d0cc6c2db296a336">getQPIClocks</a></div><div class="ttdeci">uint64 getQPIClocks(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns QPI LL clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2100</div></div>
<div class="ttc" id="structEventSelectRegister_html"><div class="ttname"><a href="structEventSelectRegister.html">EventSelectRegister</a></div><div class="ttdef"><b>Definition:</b> types.h:301</div></div>
<div class="ttc" id="classPCM_html_a33b53ec23752cb1fe3dc7e166abbe13e"><div class="ttname"><a href="classPCM.html#a33b53ec23752cb1fe3dc7e166abbe13e">PCM::isClientCPU</a></div><div class="ttdeci">bool isClientCPU() const</div><div class="ttdoc">Returns whether it is a client part. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1434</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_abc8b36bca06eaa243b1013ae19374c2c"><div class="ttname"><a href="classServerPCICFGUncore.html#abc8b36bca06eaa243b1013ae19374c2c">ServerPCICFGUncore::getNumEDCChannels</a></div><div class="ttdeci">size_t getNumEDCChannels() const</div><div class="ttdoc">Returns the total number of detected memory channels on all embedded DRAM controllers (EDC) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:482</div></div>
<div class="ttc" id="cpucounters_8h_html_a0b914c4bffa783271c276b29be582370"><div class="ttname"><a href="cpucounters_8h.html#a0b914c4bffa783271c276b29be582370">getAllOutgoingQPILinkBytes</a></div><div class="ttdeci">uint64 getAllOutgoingQPILinkBytes(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of total QPI data+nondata traffic. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3348</div></div>
<div class="ttc" id="types_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div><div class="ttdoc">Internal type and constant definitions. </div></div>
<div class="ttc" id="classPCM_html_a9911d0d2edf17ecffd24ffce5a31a982"><div class="ttname"><a href="classPCM.html#a9911d0d2edf17ecffd24ffce5a31a982">PCM::getPCUFrequency</a></div><div class="ttdeci">uint64 getPCUFrequency() const</div><div class="ttdoc">Returns the frequency of Power Control Unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1393</div></div>
<div class="ttc" id="cpucounters_8h_html_a1615063ac14cde3ace1a91bfb349f3f9"><div class="ttname"><a href="cpucounters_8h.html#a1615063ac14cde3ace1a91bfb349f3f9">getMCDRAMClocks</a></div><div class="ttdeci">uint64 getMCDRAMClocks(uint32 channel, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns MCDRAM clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2175</div></div>
<div class="ttc" id="classPCM__Util_1_1Mutex_html"><div class="ttname"><a href="classPCM__Util_1_1Mutex.html">PCM_Util::Mutex</a></div><div class="ttdef"><b>Definition:</b> mutex.h:14</div></div>
<div class="ttc" id="classPCM_html_adb5b4989751f87a17649810a964fa053"><div class="ttname"><a href="classPCM.html#adb5b4989751f87a17649810a964fa053">PCM::setRunState</a></div><div class="ttdeci">void setRunState(int new_state)</div><div class="ttdoc">Set Run State. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:636</div></div>
<div class="ttc" id="classSocketCounterState_html"><div class="ttname"><a href="classSocketCounterState.html">SocketCounterState</a></div><div class="ttdoc">Socket-wide counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2484</div></div>
<div class="ttc" id="cpucounters_8h_html_a94118e70266db2ed7fc6b8b7b4e2c343"><div class="ttname"><a href="cpucounters_8h.html#a94118e70266db2ed7fc6b8b7b4e2c343">getL3CacheMisses</a></div><div class="ttdeci">uint64 getL3CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2855</div></div>
<div class="ttc" id="classAggregator_html"><div class="ttname"><a href="classAggregator.html">Aggregator</a></div><div class="ttdef"><b>Definition:</b> topology.h:467</div></div>
<div class="ttc" id="structcounter_html"><div class="ttname"><a href="structcounter.html">counter</a></div><div class="ttdef"><b>Definition:</b> lspci.h:75</div></div>
<div class="ttc" id="client__bw_8h_html"><div class="ttname"><a href="client__bw_8h.html">client_bw.h</a></div><div class="ttdoc">Interface to access client bandwidth counters. </div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ae3421871d5942f1835af1fe4c282950b"><div class="ttname"><a href="classServerPCICFGUncore.html#ae3421871d5942f1835af1fe4c282950b">ServerPCICFGUncore::getQPILinkSpeed</a></div><div class="ttdeci">uint64 getQPILinkSpeed(const uint32 linkNr) const</div><div class="ttdoc">Returns the speed of the QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:463</div></div>
<div class="ttc" id="classPCM_html_a491397535c61bdc2ed5c3e8c9e229d2d"><div class="ttname"><a href="classPCM.html#a491397535c61bdc2ed5c3e8c9e229d2d">PCM::isServerCPU</a></div><div class="ttdeci">bool isServerCPU() const</div><div class="ttdoc">Returns whether it is a server part. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1412</div></div>
<div class="ttc" id="cpucounters_8h_html_aca1b1d8ba1679c4a0c394c2647428fd3"><div class="ttname"><a href="cpucounters_8h.html#aca1b1d8ba1679c4a0c394c2647428fd3">getIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getIncomingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI data traffic per incoming QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3220</div></div>
<div class="ttc" id="structFixedEventControlRegister_html"><div class="ttname"><a href="structFixedEventControlRegister.html">FixedEventControlRegister</a></div><div class="ttdef"><b>Definition:</b> types.h:336</div></div>
<div class="ttc" id="classPCM_html_a30210eb2ddc9eee6bfe1db4b159f922b"><div class="ttname"><a href="classPCM.html#a30210eb2ddc9eee6bfe1db4b159f922b">PCM::getNumOnlineCores</a></div><div class="ttdeci">uint32 getNumOnlineCores() const</div><div class="ttdoc">Reads number of online logical cores in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4272</div></div>
<div class="ttc" id="classPCM_html_a7ca50e5907ef2b7cf7c81a5e069135f7"><div class="ttname"><a href="classPCM.html#a7ca50e5907ef2b7cf7c81a5e069135f7">PCM::SupportedCPUModels</a></div><div class="ttdeci">SupportedCPUModels</div><div class="ttdoc">Identifiers of supported CPU models. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1177</div></div>
<div class="ttc" id="cpucounters_8h_html_abaca7147e6334e13bbbc718e4a537568"><div class="ttname"><a href="cpucounters_8h.html#abaca7147e6334e13bbbc718e4a537568">getCoreIPC</a></div><div class="ttdeci">double getCoreIPC(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per core cycle for the entire system combining instru...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2721</div></div>
<div class="ttc" id="cpucounters_8h_html_a7ba16714ef7ed547ad8648cb5b9e52f6"><div class="ttname"><a href="cpucounters_8h.html#a7ba16714ef7ed547ad8648cb5b9e52f6">getL3CacheHits</a></div><div class="ttdeci">uint64 getL3CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes total number of L3 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2981</div></div>
<div class="ttc" id="cpucounters_8h_html_a4b1050ca9ccdd66661df556bab70fd0f"><div class="ttname"><a href="cpucounters_8h.html#a4b1050ca9ccdd66661df556bab70fd0f">getL3CacheHitsSnoop</a></div><div class="ttdeci">uint64 getL3CacheHitsSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where snooping in sibling L2 caches had to be done. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2963</div></div>
<div class="ttc" id="classCoreTaskQueue_html"><div class="ttname"><a href="classCoreTaskQueue.html">CoreTaskQueue</a></div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:1714</div></div>
<div class="ttc" id="classServerPCICFGUncore_html"><div class="ttname"><a href="classServerPCICFGUncore.html">ServerPCICFGUncore</a></div><div class="ttdoc">Object to access uncore counters in a socket/processor with microarchitecture codename SandyBridge-EP...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:291</div></div>
<div class="ttc" id="cpucounters_8h_html_a71af0766460ef7dd3d138ec0d0924eda"><div class="ttname"><a href="cpucounters_8h.html#a71af0766460ef7dd3d138ec0d0924eda">getDRAMConsumedEnergy</a></div><div class="ttdeci">uint64 getDRAMConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by DRAM (measured in internal units) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2257</div></div>
<div class="ttc" id="classPCM_html_a9b2b73d2af7c5a851e5c43df37d7fdb2"><div class="ttname"><a href="classPCM.html#a9b2b73d2af7c5a851e5c43df37d7fdb2">PCM::CoreRemoteMemoryBWMetricAvailable</a></div><div class="ttdeci">bool CoreRemoteMemoryBWMetricAvailable() const</div><div class="ttdoc">checks if total memory bandwidth monitoring present </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:614</div></div>
<div class="ttc" id="structTopologyEntry_html"><div class="ttname"><a href="structTopologyEntry.html">TopologyEntry</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:86</div></div>
<div class="ttc" id="cpucounters_8h_html_a185f850a9a753d9cf4deb8299261fd4c"><div class="ttname"><a href="cpucounters_8h.html#a185f850a9a753d9cf4deb8299261fd4c">getL3CacheOccupancy</a></div><div class="ttdeci">uint64 getL3CacheOccupancy(const CounterStateType &amp;now)</div><div class="ttdoc">Computes L3 Cache Occupancy. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2911</div></div>
<div class="ttc" id="cpucounters_8h_html_ad3fd926e1850510a693196af34206483"><div class="ttname"><a href="cpucounters_8h.html#ad3fd926e1850510a693196af34206483">getSocketCounterState</a></div><div class="ttdeci">PCM_API SocketCounterState getSocketCounterState(uint32 socket)</div><div class="ttdoc">Reads the counter state of a socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3456</div></div>
<div class="ttc" id="classPCM_html_a6a6580b296a5a0236c9e00956988c0fc"><div class="ttname"><a href="classPCM.html#a6a6580b296a5a0236c9e00956988c0fc">PCM::L3CacheOccupancyMetricAvailable</a></div><div class="ttdeci">bool L3CacheOccupancyMetricAvailable() const</div><div class="ttdoc">checks if L3 cache monitoring present </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:595</div></div>
<div class="ttc" id="classPCM_html_a7d4964e57e7692b5cc67d8b5056e5299"><div class="ttname"><a href="classPCM.html#a7d4964e57e7692b5cc67d8b5056e5299">PCM::getNumSockets</a></div><div class="ttdeci">uint32 getNumSockets() const</div><div class="ttdoc">Reads number of sockets (CPUs) in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4277</div></div>
<div class="ttc" id="classPCM_html_a88584813a3ef51376efeb22928764786"><div class="ttname"><a href="classPCM.html#a88584813a3ef51376efeb22928764786">PCM::ProgramMode</a></div><div class="ttdeci">ProgramMode</div><div class="ttdoc">Mode of programming (parameter in the program() method) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:654</div></div>
<div class="ttc" id="classPCM_html_a2b4433865e00da98c4fa588cb1be913c"><div class="ttname"><a href="classPCM.html#a2b4433865e00da98c4fa588cb1be913c">PCM::getTileId</a></div><div class="ttdeci">int32 getTileId(uint32 os_id) const</div><div class="ttdoc">Determines physical tile (cores sharing L2 cache) of given processor ID. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1235</div></div>
<div class="ttc" id="cpucounters_8h_html_a5922acedeec3c1cc67d20670f8ef0518"><div class="ttname"><a href="cpucounters_8h.html#a5922acedeec3c1cc67d20670f8ef0518">getL2CacheHitRatio</a></div><div class="ttdeci">double getL2CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L2 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2823</div></div>
<div class="ttc" id="cpucounters_8h_html_a159a6896f5ef3626b88cdd27a3c15ac0"><div class="ttname"><a href="cpucounters_8h.html#a159a6896f5ef3626b88cdd27a3c15ac0">getExecUsage</a></div><div class="ttdeci">double getExecUsage(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per time intervall. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2642</div></div>
<div class="ttc" id="cpucounters_8h_html_a580ae4e465d0f8dd93935ad7af28c095"><div class="ttname"><a href="cpucounters_8h.html#a580ae4e465d0f8dd93935ad7af28c095">getQPIL1Cycles</a></div><div class="ttdeci">uint64 getQPIL1Cycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving shutdown mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2129</div></div>
<div class="ttc" id="classPCM_html_af0f62775b214218edf64a3f68df6c932"><div class="ttname"><a href="classPCM.html#af0f62775b214218edf64a3f68df6c932">PCM::getQPILinksPerSocket</a></div><div class="ttdeci">uint64 getQPILinksPerSocket() const</div><div class="ttdoc">Returns the number of Intel(r) Quick Path Interconnect(tm) links per socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1244</div></div>
<div class="ttc" id="classPCM_html_ad3038bc44fb2fdd31e072b8cc8cf4b09"><div class="ttname"><a href="classPCM.html#ad3038bc44fb2fdd31e072b8cc8cf4b09">PCM::getPackageMinimumPower</a></div><div class="ttdeci">int32 getPackageMinimumPower() const</div><div class="ttdoc">Returns minimum power derived from electrical spec of the package domain in Watt. ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1468</div></div>
<div class="ttc" id="cpucounters_8h_html_af8f7dab111f6b8cbcfa0c1b81e1860fb"><div class="ttname"><a href="cpucounters_8h.html#af8f7dab111f6b8cbcfa0c1b81e1860fb">getConsumedJoules</a></div><div class="ttdeci">double getConsumedJoules(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns Joules consumed by processor (excluding DRAM) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2267</div></div>
<div class="ttc" id="classPCM_html_af47f2de0de9403d00a4dac72919c8c38"><div class="ttname"><a href="classPCM.html#af47f2de0de9403d00a4dac72919c8c38">PCM::getMCPerSocket</a></div><div class="ttdeci">uint32 getMCPerSocket() const</div><div class="ttdoc">Returns the number of detected integrated memory controllers per socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1270</div></div>
<div class="ttc" id="classJSONPrinter_html"><div class="ttname"><a href="classJSONPrinter.html">JSONPrinter</a></div><div class="ttdef"><b>Definition:</b> pcm-sensor-server.cpp:267</div></div>
<div class="ttc" id="cpucounters_8h_html_a054b949f09283093e1923affa4e58ae8"><div class="ttname"><a href="cpucounters_8h.html#a054b949f09283093e1923affa4e58ae8">getConsumedEnergy</a></div><div class="ttdeci">uint64 getConsumedEnergy(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns energy consumed by processor, excluding DRAM (measured in internal units) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2247</div></div>
<div class="ttc" id="cpucounters_8h_html_a7dc8446d1f6172bdac1401e5d3ec0a4d"><div class="ttname"><a href="cpucounters_8h.html#a7dc8446d1f6172bdac1401e5d3ec0a4d">getM2MCounter</a></div><div class="ttdeci">uint64 getM2MCounter(uint32 controller, uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of Memory2Mesh controller PMU counter (counter meaning depends on the programming: power/...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2201</div></div>
<div class="ttc" id="classBasicCounterState_html_a57d93ca07fed611468739280015a3448"><div class="ttname"><a href="classBasicCounterState.html#a57d93ca07fed611468739280015a3448">BasicCounterState::getThermalHeadroom</a></div><div class="ttdeci">int32 getThermalHeadroom() const</div><div class="ttdoc">Returns current thermal headroom below TjMax. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2051</div></div>
<div class="ttc" id="classMSRRegister_html"><div class="ttname"><a href="classMSRRegister.html">MSRRegister</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:190</div></div>
<div class="ttc" id="cpucounters_8h_html_a9a351e598b8af26131611ff37b592633"><div class="ttname"><a href="cpucounters_8h.html#a9a351e598b8af26131611ff37b592633">getActiveRelativeFrequency</a></div><div class="ttdeci">double getActiveRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2805</div></div>
<div class="ttc" id="classSystemCounterState_html"><div class="ttname"><a href="classSystemCounterState.html">SystemCounterState</a></div><div class="ttdoc">System-wide counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2522</div></div>
<div class="ttc" id="classSystemRoot_html"><div class="ttname"><a href="classSystemRoot.html">SystemRoot</a></div><div class="ttdef"><b>Definition:</b> topology.h:362</div></div>
<div class="ttc" id="cpucounters_8h_html_aa5a7caff83891aafc6e9eb20501170cc"><div class="ttname"><a href="cpucounters_8h.html#aa5a7caff83891aafc6e9eb20501170cc">getNormalizedQPIL0pTxCycles</a></div><div class="ttdeci">double getNormalizedQPIL0pTxCycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the ratio of QPI cycles in power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2141</div></div>
<div class="ttc" id="cpucounters_8h_html_acdac5d9d7a5a6496d90b0681badc26b3"><div class="ttname"><a href="cpucounters_8h.html#acdac5d9d7a5a6496d90b0681badc26b3">getQPIL0pTxCycles</a></div><div class="ttdeci">uint64 getQPIL0pTxCycles(uint32 port, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of QPI cycles in power saving half-lane mode. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2118</div></div>
<div class="ttc" id="cpucounters_8h_html_a98aa8d4eb21e8a992fc181d65018e5ce"><div class="ttname"><a href="cpucounters_8h.html#a98aa8d4eb21e8a992fc181d65018e5ce">getCoreCStateResidency</a></div><div class="ttdeci">double getCoreCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the core C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3009</div></div>
<div class="ttc" id="classPCM_html_aa6ec2128018c26d8c6dc70a41dae2080"><div class="ttname"><a href="classPCM.html#aa6ec2128018c26d8c6dc70a41dae2080">PCM::getMCChannels</a></div><div class="ttdeci">size_t getMCChannels(uint32 socket, uint32 controller) const</div><div class="ttdoc">Returns the number of detected memory channels on given integrated memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1320</div></div>
<div class="ttc" id="classPCM_html_a83cd795814da47148632b24e485e6075"><div class="ttname"><a href="classPCM.html#a83cd795814da47148632b24e485e6075">PCM::getNominalFrequency</a></div><div class="ttdeci">uint64 getNominalFrequency() const</div><div class="ttdoc">Reads the nominal core frequency. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4298</div></div>
<div class="ttc" id="cpucounters_8h_html_aeb1baf7feb391c0512dc378a9fd66a17"><div class="ttname"><a href="cpucounters_8h.html#aeb1baf7feb391c0512dc378a9fd66a17">getDRAMClocks</a></div><div class="ttdeci">uint64 getDRAMClocks(uint32 channel, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns DRAM clock ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2164</div></div>
<div class="ttc" id="classServerUncoreCounterState_html"><div class="ttname"><a href="classServerUncoreCounterState.html">ServerUncoreCounterState</a></div><div class="ttdoc">Server uncore power counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2409</div></div>
<div class="ttc" id="classPCM_html_ad23a4c0feeda389a1e56191a5740f95a"><div class="ttname"><a href="classPCM.html#ad23a4c0feeda389a1e56191a5740f95a">PCM::getSystemTopology</a></div><div class="ttdeci">SystemRoot const  &amp; getSystemTopology() const</div><div class="ttdoc">The system, sockets, uncores, cores and threads are structured like a tree. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:916</div></div>
<div class="ttc" id="structPCM_1_1CustomCoreEventDescription_html"><div class="ttname"><a href="structPCM_1_1CustomCoreEventDescription.html">PCM::CustomCoreEventDescription</a></div><div class="ttdoc">Custom Core event description. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:725</div></div>
<div class="ttc" id="cpucounters_8h_html_a5e34f7b0326dda86b54fcb7bb84a0b38"><div class="ttname"><a href="cpucounters_8h.html#a5e34f7b0326dda86b54fcb7bb84a0b38">getPackageCStateResidency</a></div><div class="ttdeci">double getPackageCStateResidency(int state, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes residency in the package C-state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3053</div></div>
<div class="ttc" id="cpucounters_8h_html_ae86f464068c1f531fd40612fa9ae0c7a"><div class="ttname"><a href="cpucounters_8h.html#ae86f464068c1f531fd40612fa9ae0c7a">getBytesWrittenToPMM</a></div><div class="ttdeci">uint64 getBytesWrittenToPMM(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes written to PMM memory. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3133</div></div>
<div class="ttc" id="cpucounters_8h_html_aface6421f7c3e654bcf411abd7cea990"><div class="ttname"><a href="cpucounters_8h.html#aface6421f7c3e654bcf411abd7cea990">getBytesWrittenToEDC</a></div><div class="ttdeci">uint64 getBytesWrittenToEDC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes written to MCDRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3161</div></div>
<div class="ttc" id="cpucounters_8h_html_a1f83dc2b6cd3a1efcd850003e26c6404"><div class="ttname"><a href="cpucounters_8h.html#a1f83dc2b6cd3a1efcd850003e26c6404">getAllIncomingQPILinkBytes</a></div><div class="ttdeci">uint64 getAllIncomingQPILinkBytes(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of total QPI data traffic. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3326</div></div>
<div class="ttc" id="classUncoreCounterState_html"><div class="ttname"><a href="classUncoreCounterState.html">UncoreCounterState</a></div><div class="ttdoc">Basic uncore counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2310</div></div>
<div class="ttc" id="classPCM_html_a2dd024b683196cfbd6106252c47c3337"><div class="ttname"><a href="classPCM.html#a2dd024b683196cfbd6106252c47c3337">PCM::getPackageThermalSpecPower</a></div><div class="ttdeci">int32 getPackageThermalSpecPower() const</div><div class="ttdoc">Returns thermal specification power of the package domain in Watt. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1465</div></div>
<div class="ttc" id="cpucounters_8h_html_a24fce7df2ee7140db18ecfcd74fe63d1"><div class="ttname"><a href="cpucounters_8h.html#a24fce7df2ee7140db18ecfcd74fe63d1">getBytesWrittenToMC</a></div><div class="ttdeci">uint64 getBytesWrittenToMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes written to DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3105</div></div>
<div class="ttc" id="structPCM_1_1ExtendedCustomCoreEventDescription_html"><div class="ttname"><a href="structPCM_1_1ExtendedCustomCoreEventDescription.html">PCM::ExtendedCustomCoreEventDescription</a></div><div class="ttdoc">Extended custom core event description. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:739</div></div>
<div class="ttc" id="classPCM_html_ae933960b6244fe1d96ec4306a61c0e3a"><div class="ttname"><a href="classPCM.html#ae933960b6244fe1d96ec4306a61c0e3a">PCM::getJoulesPerEnergyUnit</a></div><div class="ttdeci">double getJoulesPerEnergyUnit() const</div><div class="ttdoc">Returns how many joules are in an internal processor energy unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1462</div></div>
<div class="ttc" id="cpucounters_8h_html_abc0a6dbd1fb8151d5095443c0916ce78"><div class="ttname"><a href="cpucounters_8h.html#abc0a6dbd1fb8151d5095443c0916ce78">getCoreCounterState</a></div><div class="ttdeci">PCM_API CoreCounterState getCoreCounterState(uint32 core)</div><div class="ttdoc">Reads the counter state of a (logical) core. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3464</div></div>
<div class="ttc" id="cpucounters_8h_html_a963d78be64ccddb4f7686405ef4df9c1"><div class="ttname"><a href="cpucounters_8h.html#a963d78be64ccddb4f7686405ef4df9c1">getActiveAverageFrequency</a></div><div class="ttdeci">double getActiveAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency when not in powersaving C0-state (also taking Intel Turbo Boost techn...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2772</div></div>
<div class="ttc" id="cpucounters_8h_html_a806e72bc51f05acc4af0667ca3334242"><div class="ttname"><a href="cpucounters_8h.html#a806e72bc51f05acc4af0667ca3334242">getRelativeFrequency</a></div><div class="ttdeci">double getRelativeFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2789</div></div>
<div class="ttc" id="classCounterWidthExtenderRegister_html"><div class="ttname"><a href="classCounterWidthExtenderRegister.html">CounterWidthExtenderRegister</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:212</div></div>
<div class="ttc" id="cpucounters_8h_html_aed082cc97dbad35e1633823e582afa0f"><div class="ttname"><a href="cpucounters_8h.html#aed082cc97dbad35e1633823e582afa0f">getMCCounter</a></div><div class="ttdeci">uint64 getMCCounter(uint32 channel, uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of memory controller PMU counter (counter meaning depends on the programming: power/perfo...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2188</div></div>
<div class="ttc" id="classPCM_html_a5f8c7d4c978238706fe74ec00c803f9a"><div class="ttname"><a href="classPCM.html#a5f8c7d4c978238706fe74ec00c803f9a">PCM::getCPUModel</a></div><div class="ttdeci">uint32 getCPUModel() const</div><div class="ttdoc">Reads CPU model id. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1216</div></div>
<div class="ttc" id="classMMIORegister32_html"><div class="ttname"><a href="classMMIORegister32.html">MMIORegister32</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:170</div></div>
<div class="ttc" id="classPCM_html_afcf71f98767227aa64821a715bfab099"><div class="ttname"><a href="classPCM.html#afcf71f98767227aa64821a715bfab099">PCM::getCPUStepping</a></div><div class="ttdeci">uint32 getCPUStepping() const</div><div class="ttdoc">Reads CPU stepping id. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1220</div></div>
<div class="ttc" id="cpucounters_8h_html_a996fd8a127111e06540302cf9ccb24a7"><div class="ttname"><a href="cpucounters_8h.html#a996fd8a127111e06540302cf9ccb24a7">getEDCCounter</a></div><div class="ttdeci">uint64 getEDCCounter(uint32 channel, uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of embedded DRAM memory controller counter (counter meaning depends on the programming: p...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2214</div></div>
<div class="ttc" id="cpucounters_8h_html_a7b03f0cd02862716d717e897032b7885"><div class="ttname"><a href="cpucounters_8h.html#a7b03f0cd02862716d717e897032b7885">getL3CacheHitRatio</a></div><div class="ttdeci">double getL3CacheHitRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes L3 cache hit ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2839</div></div>
<div class="ttc" id="cpucounters_8h_html_aa398facfd523b7dcdbf827a74970a88c"><div class="ttname"><a href="cpucounters_8h.html#aa398facfd523b7dcdbf827a74970a88c">getAverageFrequency</a></div><div class="ttdeci">double getAverageFrequency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average core frequency also taking Intel Turbo Boost technology into account. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2755</div></div>
<div class="ttc" id="cpucounters_8h_html_a7a00cd524240b3c46d07ef9be7a6cdea"><div class="ttname"><a href="cpucounters_8h.html#a7a00cd524240b3c46d07ef9be7a6cdea">getSystemCounterState</a></div><div class="ttdeci">PCM_API SystemCounterState getSystemCounterState()</div><div class="ttdoc">Reads the counter state of the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3448</div></div>
<div class="ttc" id="cpucounters_8h_html_a7e5434dba3a810501f289329e52b889d"><div class="ttname"><a href="cpucounters_8h.html#a7e5434dba3a810501f289329e52b889d">getIORequestBytesFromMC</a></div><div class="ttdeci">uint64 getIORequestBytesFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes of read/write requests from all IO sources. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3176</div></div>
<div class="ttc" id="cpucounters_8h_html_ace0e3ffc23c20d0eda7663cb7e4899a2"><div class="ttname"><a href="cpucounters_8h.html#ace0e3ffc23c20d0eda7663cb7e4899a2">getL3CacheHitsNoSnoop</a></div><div class="ttdeci">uint64 getL3CacheHitsNoSnoop(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L3 cache hits where no snooping in sibling L2 caches had to be done...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2949</div></div>
<div class="ttc" id="classPCM_html_a5fc8a2d2073ce855558d201883ecf3cd"><div class="ttname"><a href="classPCM.html#a5fc8a2d2073ce855558d201883ecf3cd">PCM::getRunState</a></div><div class="ttdeci">int getRunState(void)</div><div class="ttdoc">Returns program&amp;#39;s Run State. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:642</div></div>
<div class="ttc" id="cpucounters_8h_html_a8a7e839f24a02691d4b3509fc2adee51"><div class="ttname"><a href="cpucounters_8h.html#a8a7e839f24a02691d4b3509fc2adee51">getBytesReadFromEDC</a></div><div class="ttdeci">uint64 getBytesReadFromEDC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes read from MCDRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3147</div></div>
<div class="ttc" id="cpucounters_8h_html_a6bdb34d102d7353421bd878da7b9ef23"><div class="ttname"><a href="cpucounters_8h.html#a6bdb34d102d7353421bd878da7b9ef23">getOutgoingQPILinkBytes</a></div><div class="ttdeci">uint64 getOutgoingQPILinkBytes(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get estimation of QPI (data+nondata) traffic per outgoing QPI link. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3306</div></div>
<div class="ttc" id="classPCM_html_a28d9a0ddb37cc4f87ac95b544cc36c9b"><div class="ttname"><a href="classPCM.html#a28d9a0ddb37cc4f87ac95b544cc36c9b">PCM::isAtom</a></div><div class="ttdeci">bool isAtom() const</div><div class="ttdoc">returns true if CPU is Atom-based </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1602</div></div>
<div class="ttc" id="cpucounters_8h_html_a45cf07a8d3ce2c48968842554a3854f9"><div class="ttname"><a href="cpucounters_8h.html#a45cf07a8d3ce2c48968842554a3854f9">getInvariantTSC</a></div><div class="ttdeci">uint64 getInvariantTSC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of invariant time stamp counter ticks. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2996</div></div>
<div class="ttc" id="pci_8h_html"><div class="ttname"><a href="pci_8h.html">pci.h</a></div><div class="ttdoc">Low level interface to access PCI configuration space. </div></div>
<div class="ttc" id="cpucounters_8h_html_a74fe887976e82116d27513e162a9a089"><div class="ttname"><a href="cpucounters_8h.html#a74fe887976e82116d27513e162a9a089">getNumberOfEvents</a></div><div class="ttdeci">uint64 getNumberOfEvents(const CounterType &amp;before, const CounterType &amp;after)</div><div class="ttdoc">Returns the raw count of events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3458</div></div>
<div class="ttc" id="structPCM_1_1SimplePCIeDevInfo_html"><div class="ttname"><a href="structPCM_1_1SimplePCIeDevInfo.html">PCM::SimplePCIeDevInfo</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:709</div></div>
<div class="ttc" id="classPCM_html_a9927f044c832bbdcd369c7bc1ad986c6"><div class="ttname"><a href="classPCM.html#a9927f044c832bbdcd369c7bc1ad986c6">PCM::programServerUncoreMemoryMetrics</a></div><div class="ttdeci">ErrorCode programServerUncoreMemoryMetrics(int rankA=-1, int rankB=-1, bool PMM=false, bool PMMMixedMode=false)</div><div class="ttdoc">Programs uncore memory counters on microarchitectures codename SandyBridge-EP and later Xeon uarch...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:3634</div></div>
<div class="ttc" id="cpucounters_8h_html_aaa3691b803702deec828d0d8d8a8f326"><div class="ttname"><a href="cpucounters_8h.html#aaa3691b803702deec828d0d8d8a8f326">getRefCycles</a></div><div class="ttdeci">uint64 getRefCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of reference clock cycles while clock signal on the core is running. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2695</div></div>
<div class="ttc" id="cpucounters_8h_html_acd430f703c67fc7dc0829d624ba657af"><div class="ttname"><a href="cpucounters_8h.html#acd430f703c67fc7dc0829d624ba657af">getPCUClocks</a></div><div class="ttdeci">uint64 getPCUClocks(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns clock ticks of power control unit. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2237</div></div>
<div class="ttc" id="width__extender_8h_html"><div class="ttname"><a href="width__extender_8h.html">width_extender.h</a></div><div class="ttdoc">Provides 64-bit &quot;virtual&quot; counters from underlying 32-bit HW counters. </div></div>
<div class="ttc" id="classPCM_html_a4261a7c1980c16cfe289856401aa3bee"><div class="ttname"><a href="classPCM.html#a4261a7c1980c16cfe289856401aa3bee">PCM::allowMultipleInstances</a></div><div class="ttdeci">void allowMultipleInstances()</div><div class="ttdoc">Call it before program() to allow multiple running instances of PCM on the same system. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:648</div></div>
<div class="ttc" id="cpucounters_8h_html_ab7b921e53cadd4e1504c90c400bd8b18"><div class="ttname"><a href="cpucounters_8h.html#ab7b921e53cadd4e1504c90c400bd8b18">getLocalMemoryRequestRatio</a></div><div class="ttdeci">double getLocalMemoryRequestRatio(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Get local memory access ration measured in home agent. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3445</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_ab59fb235a87be897547b1c32534d1a5f"><div class="ttname"><a href="classServerPCICFGUncore.html#ab59fb235a87be897547b1c32534d1a5f">ServerPCICFGUncore::getNumMCChannels</a></div><div class="ttdeci">size_t getNumMCChannels() const</div><div class="ttdoc">Returns the total number of detected memory channels on all integrated memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:475</div></div>
<div class="ttc" id="cpucounters_8h_html_a00c97b1a7d8a7125ce7fd129cddb52e8"><div class="ttname"><a href="cpucounters_8h.html#a00c97b1a7d8a7125ce7fd129cddb52e8">getRemoteMemoryBW</a></div><div class="ttdeci">uint64 getRemoteMemoryBW(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes Remote Memory Bandwidth. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2930</div></div>
<div class="ttc" id="cpucounters_8h_html_a5a3275c4f489a475f1658f4546567af4"><div class="ttname"><a href="cpucounters_8h.html#a5a3275c4f489a475f1658f4546567af4">getCycles</a></div><div class="ttdeci">uint64 getCycles(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number core clock cycles when signal on a specific core is running (not halted) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2679</div></div>
<div class="ttc" id="classPCM_html_a850a9aeee162133adbc4b5d8df679639"><div class="ttname"><a href="classPCM.html#a850a9aeee162133adbc4b5d8df679639">PCM::getThreadsPerCore</a></div><div class="ttdeci">uint32 getThreadsPerCore() const</div><div class="ttdoc">Reads how many hardware threads has a physical core &quot;Hardware thread&quot; is a logical core in a differen...</div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4288</div></div>
<div class="ttc" id="classUncorePMU_html"><div class="ttname"><a href="classUncorePMU.html">UncorePMU</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:240</div></div>
<div class="ttc" id="cpucounters_8h_html_a0ba3a5b71b7dd6b84c345f8cbc795b1c"><div class="ttname"><a href="cpucounters_8h.html#a0ba3a5b71b7dd6b84c345f8cbc795b1c">getIncomingQPILinkUtilization</a></div><div class="ttdeci">double getIncomingQPILinkUtilization(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get data utilization of incoming QPI link (0..1) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3239</div></div>
<div class="ttc" id="classPCM_html_a015a39143b7bb87b41dc34b43a926029"><div class="ttname"><a href="classPCM.html#a015a39143b7bb87b41dc34b43a926029">PCM::getSocketId</a></div><div class="ttdeci">int32 getSocketId(uint32 core_id) const</div><div class="ttdoc">Determines socket of given core. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1240</div></div>
<div class="ttc" id="structIIOPMUCNTCTLRegister_html"><div class="ttname"><a href="structIIOPMUCNTCTLRegister.html">IIOPMUCNTCTLRegister</a></div><div class="ttdef"><b>Definition:</b> types.h:926</div></div>
<div class="ttc" id="classServerUncoreCounterState_html_ac02003a3242a83278e429f34707e4966"><div class="ttname"><a href="classServerUncoreCounterState.html#ac02003a3242a83278e429f34707e4966">ServerUncoreCounterState::getPackageThermalHeadroom</a></div><div class="ttdeci">int32 getPackageThermalHeadroom() const</div><div class="ttdoc">Returns current thermal headroom below TjMax. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2456</div></div>
<div class="ttc" id="classPCM_html_af0648834f063a6bd2ea88c61a2ba286d"><div class="ttname"><a href="classPCM.html#af0648834f063a6bd2ea88c61a2ba286d">PCM::CoreLocalMemoryBWMetricAvailable</a></div><div class="ttdeci">bool CoreLocalMemoryBWMetricAvailable() const</div><div class="ttdoc">checks if local memory bandwidth monitoring present </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:604</div></div>
<div class="ttc" id="cpucounters_8h_html_a3ba7c9267c6e0f338a59defc98ae0007"><div class="ttname"><a href="cpucounters_8h.html#a3ba7c9267c6e0f338a59defc98ae0007">getLocalMemoryBW</a></div><div class="ttdeci">uint64 getLocalMemoryBW(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes Local Memory Bandwidth. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2920</div></div>
<div class="ttc" id="cpucounters_8h_html_abaa9d828b52f41866bf7dc8ff491a62e"><div class="ttname"><a href="cpucounters_8h.html#abaa9d828b52f41866bf7dc8ff491a62e">getNumberOfCustomEvents</a></div><div class="ttdeci">uint64 getNumberOfCustomEvents(int32 eventCounterNr, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of occured custom core events. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3205</div></div>
<div class="ttc" id="cpucounters_8h_html_a6791e3fe842320171cbac393e55929f6"><div class="ttname"><a href="cpucounters_8h.html#a6791e3fe842320171cbac393e55929f6">getLLCReadMissLatency</a></div><div class="ttdeci">double getLLCReadMissLatency(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns average last level cache read+prefetch miss latency in ns. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3465</div></div>
<div class="ttc" id="cpucounters_8h_html_ab6f97a3386ac2d35dfd61148acde0a53"><div class="ttname"><a href="cpucounters_8h.html#ab6f97a3386ac2d35dfd61148acde0a53">getDRAMConsumedJoules</a></div><div class="ttdeci">double getDRAMConsumedJoules(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns Joules consumed by DRAM. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2280</div></div>
<div class="ttc" id="cpucounters_8h_html_af124718a7620c7bbca81232c2149f771"><div class="ttname"><a href="cpucounters_8h.html#af124718a7620c7bbca81232c2149f771">getInstructionsRetired</a></div><div class="ttdeci">uint64 getInstructionsRetired(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes the number of retired instructions. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2630</div></div>
<div class="ttc" id="classPCM_html_a9bfa5b2f12f2e98382f9d8ddbc0c02e1"><div class="ttname"><a href="classPCM.html#a9bfa5b2f12f2e98382f9d8ddbc0c02e1">PCM::getQPILinkSpeed</a></div><div class="ttdeci">uint64 getQPILinkSpeed(uint32 socketNr, uint32 linkNr) const</div><div class="ttdoc">Return QPI Link Speed in GBytes/second. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1456</div></div>
<div class="ttc" id="classPCM_html"><div class="ttname"><a href="classPCM.html">PCM</a></div><div class="ttdoc">CPU Performance Monitor. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:519</div></div>
<div class="ttc" id="classPCM_html_a90eb072bebf4be22bce23d550983f6fe"><div class="ttname"><a href="classPCM.html#a90eb072bebf4be22bce23d550983f6fe">PCM::getCoreId</a></div><div class="ttdeci">int32 getCoreId(uint32 os_id) const</div><div class="ttdoc">Determines physical core of given processor ID within a socket. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1230</div></div>
<div class="ttc" id="classPCM_html_a17084236c1d744a92adec4205415e0ad"><div class="ttname"><a href="classPCM.html#a17084236c1d744a92adec4205415e0ad">PCM::getMaxIPC</a></div><div class="ttdeci">uint32 getMaxIPC() const</div><div class="ttdoc">Returns the max number of instructions per cycle. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1358</div></div>
<div class="ttc" id="cpucounters_8h_html_ac7b1863133a9a711117fcb8b68d2d773"><div class="ttname"><a href="cpucounters_8h.html#ac7b1863133a9a711117fcb8b68d2d773">getOutgoingQPILinkUtilization</a></div><div class="ttdeci">double getOutgoingQPILinkUtilization(uint32 socketNr, uint32 linkNr, const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get utilization of outgoing QPI link (0..1) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3260</div></div>
<div class="ttc" id="cpucounters_8h_html_a3c424ad42d2439410d6ffc371335573d"><div class="ttname"><a href="cpucounters_8h.html#a3c424ad42d2439410d6ffc371335573d">getPCUCounter</a></div><div class="ttdeci">uint64 getPCUCounter(uint32 counter, const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Direct read of power control unit PMU counter (counter meaning depends on the programming: power/perf...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2227</div></div>
<div class="ttc" id="classPCICFGRegister32_html"><div class="ttname"><a href="classPCICFGRegister32.html">PCICFGRegister32</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:128</div></div>
<div class="ttc" id="classPCM_html_abae9577a1a172c944d133bef10683825"><div class="ttname"><a href="classPCM.html#abae9577a1a172c944d133bef10683825">PCM::program</a></div><div class="ttdeci">ErrorCode program(const ProgramMode mode_=DEFAULT_EVENTS, const void *parameter_=NULL)</div><div class="ttdoc">Programs performance counters. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:2014</div></div>
<div class="ttc" id="structPCM_1_1CustomIIOEventDescription_html"><div class="ttname"><a href="structPCM_1_1CustomIIOEventDescription.html">PCM::CustomIIOEventDescription</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:752</div></div>
<div class="ttc" id="classPCM_html_a7e6e4c165db2cfaabaf8f5758a29ae40"><div class="ttname"><a href="classPCM.html#a7e6e4c165db2cfaabaf8f5758a29ae40">PCM::getCPUMicrocodeLevel</a></div><div class="ttdeci">int64 getCPUMicrocodeLevel() const</div><div class="ttdoc">Get microcode level (returns -1 if retrieval not supported due to some restrictions) ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1585</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a70765cb7dc2f54fae3528e6f15c57f45"><div class="ttname"><a href="classServerPCICFGUncore.html#a70765cb7dc2f54fae3528e6f15c57f45">ServerPCICFGUncore::getNumMC</a></div><div class="ttdeci">uint32 getNumMC() const</div><div class="ttdoc">Returns the number of detected integrated memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:472</div></div>
<div class="ttc" id="cpucounters_8h_html_a291eeab262fdb93de08cdfdf50dbad58"><div class="ttname"><a href="cpucounters_8h.html#a291eeab262fdb93de08cdfdf50dbad58">getL2CacheMisses</a></div><div class="ttdeci">uint64 getL2CacheMisses(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache misses. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2869</div></div>
<div class="ttc" id="cpucounters_8h_html_a7b0019d24a77dc05b7e47cb98192fd22"><div class="ttname"><a href="cpucounters_8h.html#a7b0019d24a77dc05b7e47cb98192fd22">getIPC</a></div><div class="ttdeci">double getIPC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per core cycle (IPC) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2614</div></div>
<div class="ttc" id="classSimpleCounterState_html"><div class="ttname"><a href="classSimpleCounterState.html">SimpleCounterState</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:485</div></div>
<div class="ttc" id="classPCM_html_a51b39ec58f622cd07c07fdf03ae4f543"><div class="ttname"><a href="classPCM.html#a51b39ec58f622cd07c07fdf03ae4f543">PCM::getPackageMaximumPower</a></div><div class="ttdeci">int32 getPackageMaximumPower() const</div><div class="ttdoc">Returns maximum power derived from electrical spec of the package domain in Watt. ...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1471</div></div>
<div class="ttc" id="classPCM_html_af43f3a1e920264467a3855ced5f8162b"><div class="ttname"><a href="classPCM.html#af43f3a1e920264467a3855ced5f8162b">PCM::isCoreCStateResidencySupported</a></div><div class="ttdeci">bool isCoreCStateResidencySupported(int state)</div><div class="ttdoc">Returns true if the specified core C-state residency metric is supported. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:608</div></div>
<div class="ttc" id="cpucounters_8h_html_a5e245473e2297272a50ca054b33c8c86"><div class="ttname"><a href="cpucounters_8h.html#a5e245473e2297272a50ca054b33c8c86">getSMICount</a></div><div class="ttdeci">uint64 getSMICount(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Returns the number of occured system management interrupts. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3190</div></div>
<div class="ttc" id="classPCM_html_aad05d8a2f383ad41d25892175373b613"><div class="ttname"><a href="classPCM.html#aad05d8a2f383ad41d25892175373b613">PCM::isPackageCStateResidencySupported</a></div><div class="ttdeci">bool isPackageCStateResidencySupported(int state)</div><div class="ttdoc">Returns true if the specified package C-state residency metric is supported. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:617</div></div>
<div class="ttc" id="classCoreCounterState_html"><div class="ttname"><a href="classCoreCounterState.html">CoreCounterState</a></div><div class="ttdoc">(Logical) core-wide counter state </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2472</div></div>
<div class="ttc" id="classPCM_html_a18d1666c08f014378cf49c707fc978d1"><div class="ttname"><a href="classPCM.html#a18d1666c08f014378cf49c707fc978d1">PCM::getNumCores</a></div><div class="ttdeci">uint32 getNumCores() const</div><div class="ttdoc">Reads number of logical cores in the system. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:4267</div></div>
<div class="ttc" id="cpucounters_8h_html_a459367d7877d09594c2ecd85e04cae61"><div class="ttname"><a href="cpucounters_8h.html#a459367d7877d09594c2ecd85e04cae61">getL2CacheHits</a></div><div class="ttdeci">uint64 getL2CacheHits(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of L2 cache hits. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:2894</div></div>
<div class="ttc" id="classPCM_html_a8509261ccf013554e4ca31f66edf65af"><div class="ttname"><a href="classPCM.html#a8509261ccf013554e4ca31f66edf65af">PCM::getMCChannelsPerSocket</a></div><div class="ttdeci">size_t getMCChannelsPerSocket() const</div><div class="ttdoc">Returns the total number of detected memory channels on all integrated memory controllers per socket...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1294</div></div>
<div class="ttc" id="cpucounters_8h_html_a0f28a32a3edeaecd916ba097aee99d7f"><div class="ttname"><a href="cpucounters_8h.html#a0f28a32a3edeaecd916ba097aee99d7f">getBytesReadFromMC</a></div><div class="ttdeci">uint64 getBytesReadFromMC(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes read from DRAM memory controllers. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3091</div></div>
<div class="ttc" id="cpucounters_8h_html_afba35ab2fa127ac0af819a1134711722"><div class="ttname"><a href="cpucounters_8h.html#afba35ab2fa127ac0af819a1134711722">getBytesReadFromPMM</a></div><div class="ttdeci">uint64 getBytesReadFromPMM(const CounterStateType &amp;before, const CounterStateType &amp;after)</div><div class="ttdoc">Computes number of bytes read from PMM memory. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3119</div></div>
<div class="ttc" id="classPCM_html_a1ff51f06eed09faa5c86a616a9466925"><div class="ttname"><a href="classPCM.html#a1ff51f06eed09faa5c86a616a9466925">PCM::isAtom</a></div><div class="ttdeci">static bool isAtom(const int32 cpu_model_)</div><div class="ttdoc">returns true if CPU model is Atom-based </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1588</div></div>
<div class="ttc" id="cpucounters_8h_html_a546944a165ea621d77a524b15ccd6cf1"><div class="ttname"><a href="cpucounters_8h.html#a546944a165ea621d77a524b15ccd6cf1">getTotalExecUsage</a></div><div class="ttdeci">double getTotalExecUsage(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Computes average number of retired instructions per time intervall for the entire system combining in...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:2739</div></div>
<div class="ttc" id="classPCICFGRegister64_html"><div class="ttname"><a href="classPCICFGRegister64.html">PCICFGRegister64</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:105</div></div>
<div class="ttc" id="classPCM_html_a728347cf85816c42833a1a8a1f14b861"><div class="ttname"><a href="classPCM.html#a728347cf85816c42833a1a8a1f14b861">PCM::getThreadId</a></div><div class="ttdeci">int32 getThreadId(uint32 os_id) const</div><div class="ttdoc">Determines physical thread of given processor ID within a core. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1225</div></div>
<div class="ttc" id="classHWRegister_html"><div class="ttname"><a href="classHWRegister.html">HWRegister</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:97</div></div>
<div class="ttc" id="classPCM_html_a51b8f36a804566a381cba176107ded6d"><div class="ttname"><a href="classPCM.html#a51b8f36a804566a381cba176107ded6d">PCM::getEDCChannelsPerSocket</a></div><div class="ttdeci">size_t getEDCChannelsPerSocket() const</div><div class="ttdoc">Returns the total number of detected memory channels on all integrated memory controllers per socket...</div><div class="ttdef"><b>Definition:</b> cpucounters.h:1345</div></div>
<div class="ttc" id="classServerUncore_html"><div class="ttname"><a href="classServerUncore.html">ServerUncore</a></div><div class="ttdef"><b>Definition:</b> topology.h:256</div></div>
<div class="ttc" id="structdata_html"><div class="ttname"><a href="structdata.html">data</a></div><div class="ttdef"><b>Definition:</b> pcm-iio.cpp:56</div></div>
<div class="ttc" id="msr_8h_html"><div class="ttname"><a href="msr_8h.html">msr.h</a></div><div class="ttdoc">Low level interface to access hardware model specific registers. </div></div>
<div class="ttc" id="classPCM_html_abebf5f22d794719dfc49155741e264e5"><div class="ttname"><a href="classPCM.html#abebf5f22d794719dfc49155741e264e5">PCM::ErrorCode</a></div><div class="ttdeci">ErrorCode</div><div class="ttdoc">Return codes (e.g. for program(..) method) </div><div class="ttdef"><b>Definition:</b> cpucounters.h:662</div></div>
<div class="ttc" id="classMMIORegister64_html"><div class="ttname"><a href="classMMIORegister64.html">MMIORegister64</a></div><div class="ttdef"><b>Definition:</b> cpucounters.h:150</div></div>
<div class="ttc" id="classPCM_html_a155611028fb95409625e44784f7b4c7b"><div class="ttname"><a href="classPCM.html#a155611028fb95409625e44784f7b4c7b">PCM::getInstance</a></div><div class="ttdeci">static PCM * getInstance()</div><div class="ttdoc">Returns PCM object. </div><div class="ttdef"><b>Definition:</b> cpucounters.cpp:268</div></div>
<div class="ttc" id="classServerPCICFGUncore_html_a5dc6e057441bbbbc3d396fe8e5d7cc2f"><div class="ttname"><a href="classServerPCICFGUncore.html#a5dc6e057441bbbbc3d396fe8e5d7cc2f">ServerPCICFGUncore::getNumQPIPorts</a></div><div class="ttdeci">size_t getNumQPIPorts() const</div><div class="ttdoc">Returns the number of detected QPI ports. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:460</div></div>
<div class="ttc" id="classBasicCounterState_html"><div class="ttname"><a href="classBasicCounterState.html">BasicCounterState</a></div><div class="ttdoc">Basic core counter state. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:1909</div></div>
<div class="ttc" id="cpucounters_8h_html_a17823150d51bdebdd203dfa00b0a5f49"><div class="ttname"><a href="cpucounters_8h.html#a17823150d51bdebdd203dfa00b0a5f49">getQPItoMCTrafficRatio</a></div><div class="ttdeci">double getQPItoMCTrafficRatio(const SystemCounterState &amp;before, const SystemCounterState &amp;after)</div><div class="ttdoc">Get QPI data to Memory Controller traffic ratio. </div><div class="ttdef"><b>Definition:</b> cpucounters.h:3427</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
